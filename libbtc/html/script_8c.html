<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>libbtc: /Users/jonasschnelli/Documents/bitcoin/libbtc/src/script.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">libbtc
   </div>
   <div id="projectbrief">bitcoinclibrary</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_4356c9dd507f78627e142f7551987298.html">libbtc</a></li><li class="navelem"><a class="el" href="dir_8f7b7a4187e1479c1533fe8a28ab53cb.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">script.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;<a class="el" href="script_8h_source.html">btc/script.h</a>&gt;</code><br />
<code>#include &lt;assert.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &quot;<a class="el" href="buffer_8h_source.html">buffer.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="serialize_8h_source.html">serialize.h</a>&quot;</code><br />
</div>
<p><a href="script_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a9dd34db16bd8f086717ce69df799d7f7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="btc_8h.html#a2426de7ad9dd5354f5e22b4c8d77e792">btc_bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="script_8c.html#a9dd34db16bd8f086717ce69df799d7f7">btc_script_copy_without_op_codeseperator</a> (const <a class="el" href="structcstring.html">cstring</a> *script_in, <a class="el" href="structcstring.html">cstring</a> *script_out)</td></tr>
<tr class="separator:a9dd34db16bd8f086717ce69df799d7f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3701ef637831f94ec0bde2da6920cc56"><td class="memItemLeft" align="right" valign="top"><a class="el" href="script_8h.html#aee43ea531cade9d64d41a2a0af3c9b26">btc_script_op</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="script_8c.html#a3701ef637831f94ec0bde2da6920cc56">btc_script_op_new</a> ()</td></tr>
<tr class="separator:a3701ef637831f94ec0bde2da6920cc56"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea847aa69db6d03ee2eca62a0422c12e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="script_8c.html#aea847aa69db6d03ee2eca62a0422c12e">btc_script_op_free</a> (<a class="el" href="script_8h.html#aee43ea531cade9d64d41a2a0af3c9b26">btc_script_op</a> *script_op)</td></tr>
<tr class="separator:aea847aa69db6d03ee2eca62a0422c12e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acbd932644e53ed44327bf9d87632a1f8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="script_8c.html#acbd932644e53ed44327bf9d87632a1f8">btc_script_op_free_cb</a> (void *data)</td></tr>
<tr class="separator:acbd932644e53ed44327bf9d87632a1f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69ef4e31bc44eb4f4c90ea975ce71d44"><td class="memItemLeft" align="right" valign="top"><a class="el" href="btc_8h.html#a2426de7ad9dd5354f5e22b4c8d77e792">btc_bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="script_8c.html#a69ef4e31bc44eb4f4c90ea975ce71d44">btc_script_get_ops</a> (const <a class="el" href="structcstring.html">cstring</a> *script_in, <a class="el" href="structvector.html">vector</a> *ops_out)</td></tr>
<tr class="separator:a69ef4e31bc44eb4f4c90ea975ce71d44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7cd934910c35292ef622cb017b93a15f"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="btc_8h.html#a2426de7ad9dd5354f5e22b4c8d77e792">btc_bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="script_8c.html#a7cd934910c35292ef622cb017b93a15f">btc_script_is_pushdata</a> (enum <a class="el" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bd">opcodetype</a> op)</td></tr>
<tr class="separator:a7cd934910c35292ef622cb017b93a15f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7fafb2923ee233f3debab41e0445f5b2"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="btc_8h.html#a2426de7ad9dd5354f5e22b4c8d77e792">btc_bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="script_8c.html#a7fafb2923ee233f3debab41e0445f5b2">btc_script_is_op</a> (const <a class="el" href="script_8h.html#aee43ea531cade9d64d41a2a0af3c9b26">btc_script_op</a> *op, enum <a class="el" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bd">opcodetype</a> opcode)</td></tr>
<tr class="separator:a7fafb2923ee233f3debab41e0445f5b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a307e1cee2f4af6577f94ba4b796214e7"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="btc_8h.html#a2426de7ad9dd5354f5e22b4c8d77e792">btc_bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="script_8c.html#a307e1cee2f4af6577f94ba4b796214e7">btc_script_is_op_pubkey</a> (const <a class="el" href="script_8h.html#aee43ea531cade9d64d41a2a0af3c9b26">btc_script_op</a> *op)</td></tr>
<tr class="separator:a307e1cee2f4af6577f94ba4b796214e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2892d15f4f0a4013466f6d0f3883a710"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="btc_8h.html#a2426de7ad9dd5354f5e22b4c8d77e792">btc_bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="script_8c.html#a2892d15f4f0a4013466f6d0f3883a710">btc_script_is_op_pubkeyhash</a> (const <a class="el" href="script_8h.html#aee43ea531cade9d64d41a2a0af3c9b26">btc_script_op</a> *op)</td></tr>
<tr class="separator:a2892d15f4f0a4013466f6d0f3883a710"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a992fde7b9a8b9178e70337fe7646d813"><td class="memItemLeft" align="right" valign="top"><a class="el" href="btc_8h.html#a2426de7ad9dd5354f5e22b4c8d77e792">btc_bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="script_8c.html#a992fde7b9a8b9178e70337fe7646d813">btc_script_is_pubkey</a> (<a class="el" href="structvector.html">vector</a> *ops)</td></tr>
<tr class="separator:a992fde7b9a8b9178e70337fe7646d813"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a104cab956788e243c00e157372d852d4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="btc_8h.html#a2426de7ad9dd5354f5e22b4c8d77e792">btc_bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="script_8c.html#a104cab956788e243c00e157372d852d4">btc_script_is_pubkeyhash</a> (<a class="el" href="structvector.html">vector</a> *ops)</td></tr>
<tr class="separator:a104cab956788e243c00e157372d852d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a702b03d4e597b5d6ccdda6c15fd472e0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="btc_8h.html#a2426de7ad9dd5354f5e22b4c8d77e792">btc_bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="script_8c.html#a702b03d4e597b5d6ccdda6c15fd472e0">btc_script_is_scripthash</a> (<a class="el" href="structvector.html">vector</a> *ops)</td></tr>
<tr class="separator:a702b03d4e597b5d6ccdda6c15fd472e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f2dab716094bb061ccfb989832627d1"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="btc_8h.html#a2426de7ad9dd5354f5e22b4c8d77e792">btc_bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="script_8c.html#a5f2dab716094bb061ccfb989832627d1">btc_script_is_op_smallint</a> (const <a class="el" href="script_8h.html#aee43ea531cade9d64d41a2a0af3c9b26">btc_script_op</a> *op)</td></tr>
<tr class="separator:a5f2dab716094bb061ccfb989832627d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab366c5b2c8adcdff51bb6776bec934a3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="btc_8h.html#a2426de7ad9dd5354f5e22b4c8d77e792">btc_bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="script_8c.html#ab366c5b2c8adcdff51bb6776bec934a3">btc_script_is_multisig</a> (<a class="el" href="structvector.html">vector</a> *ops)</td></tr>
<tr class="separator:ab366c5b2c8adcdff51bb6776bec934a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a2cb7d490cc914cffa99a84c140c435"><td class="memItemLeft" align="right" valign="top">enum <a class="el" href="script_8h.html#a517c02233134e7b8b6ae330184b28b49">btc_tx_out_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="script_8c.html#a4a2cb7d490cc914cffa99a84c140c435">btc_script_classify</a> (<a class="el" href="structvector.html">vector</a> *ops)</td></tr>
<tr class="separator:a4a2cb7d490cc914cffa99a84c140c435"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afaa823442c07b63492d22aabe29f7d0f"><td class="memItemLeft" align="right" valign="top">static enum <a class="el" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bd">opcodetype</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="script_8c.html#afaa823442c07b63492d22aabe29f7d0f">btc_encode_op_n</a> (int n)</td></tr>
<tr class="separator:afaa823442c07b63492d22aabe29f7d0f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a878362f31fcd6b422a8dade0b3addecd"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="script_8c.html#a878362f31fcd6b422a8dade0b3addecd">btc_script_append_op</a> (<a class="el" href="structcstring.html">cstring</a> *script_in, enum <a class="el" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bd">opcodetype</a> op)</td></tr>
<tr class="separator:a878362f31fcd6b422a8dade0b3addecd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a43971c43d61752153441321be1c693"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="script_8c.html#a7a43971c43d61752153441321be1c693">btc_script_append_pushdata</a> (<a class="el" href="structcstring.html">cstring</a> *script_in, unsigned char *data, size_t datalen)</td></tr>
<tr class="separator:a7a43971c43d61752153441321be1c693"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a927dd82f316c4529611b91cabbd67446"><td class="memItemLeft" align="right" valign="top"><a class="el" href="btc_8h.html#a2426de7ad9dd5354f5e22b4c8d77e792">btc_bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="script_8c.html#a927dd82f316c4529611b91cabbd67446">btc_script_build_multisig</a> (<a class="el" href="structcstring.html">cstring</a> *script_in, unsigned int required_signatures, <a class="el" href="structvector.html">vector</a> *pubkeys_chars)</td></tr>
<tr class="separator:a927dd82f316c4529611b91cabbd67446"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd88498494c382afb5a3b4bade4d2dc0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="btc_8h.html#a2426de7ad9dd5354f5e22b4c8d77e792">btc_bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="script_8c.html#acd88498494c382afb5a3b4bade4d2dc0">btc_script_build_p2pkh</a> (<a class="el" href="structcstring.html">cstring</a> *script_in, const uint8_t *hash160)</td></tr>
<tr class="separator:acd88498494c382afb5a3b4bade4d2dc0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4794b5e3110aca0d40f6bc042c0561c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="btc_8h.html#a2426de7ad9dd5354f5e22b4c8d77e792">btc_bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="script_8c.html#ad4794b5e3110aca0d40f6bc042c0561c">btc_script_build_p2sh</a> (<a class="el" href="structcstring.html">cstring</a> *script_in, const uint8_t *hash160)</td></tr>
<tr class="separator:ad4794b5e3110aca0d40f6bc042c0561c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="afaa823442c07b63492d22aabe29f7d0f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static enum <a class="el" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bd">opcodetype</a> btc_encode_op_n </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="script_8c_source.html#l00257">257</a> of file <a class="el" href="script_8c_source.html">script.c</a>.</p>

<p>References <a class="el" href="script_8h_source.html#l00051">OP_0</a>, and <a class="el" href="script_8h_source.html#l00058">OP_1</a>.</p>

<p>Referenced by <a class="el" href="script_8c_source.html#l00298">btc_script_build_multisig()</a>.</p>
<div class="fragment"><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;{</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    assert(n &gt;= 0 &amp;&amp; n &lt;= 16);</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="keywordflow">if</span> (n == 0)</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bdaccd484dad2223fffdbdc2637c4f1e40e">OP_0</a>;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="keywordflow">return</span> (<span class="keyword">enum</span> <a class="code" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bd">opcodetype</a>)(<a class="code" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bda7e89d91965ffa7edb7733a5e9bf8a9f3">OP_1</a>+n-1);</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;}</div>
<div class="ttc" id="script_8h_html_a63e349a6089a54da9fe09a3d858648bd"><div class="ttname"><a href="script_8h.html#a63e349a6089a54da9fe09a3d858648bd">opcodetype</a></div><div class="ttdeci">opcodetype</div><div class="ttdef"><b>Definition:</b> <a href="script_8h_source.html#l00049">script.h:49</a></div></div>
<div class="ttc" id="script_8h_html_a63e349a6089a54da9fe09a3d858648bda7e89d91965ffa7edb7733a5e9bf8a9f3"><div class="ttname"><a href="script_8h.html#a63e349a6089a54da9fe09a3d858648bda7e89d91965ffa7edb7733a5e9bf8a9f3">OP_1</a></div><div class="ttdef"><b>Definition:</b> <a href="script_8h_source.html#l00058">script.h:58</a></div></div>
<div class="ttc" id="script_8h_html_a63e349a6089a54da9fe09a3d858648bdaccd484dad2223fffdbdc2637c4f1e40e"><div class="ttname"><a href="script_8h.html#a63e349a6089a54da9fe09a3d858648bdaccd484dad2223fffdbdc2637c4f1e40e">OP_0</a></div><div class="ttdef"><b>Definition:</b> <a href="script_8h_source.html#l00051">script.h:51</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a878362f31fcd6b422a8dade0b3addecd"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void btc_script_append_op </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcstring.html">cstring</a> *&#160;</td>
          <td class="paramname"><em>script_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bd">opcodetype</a>&#160;</td>
          <td class="paramname"><em>op</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="script_8c_source.html#l00266">266</a> of file <a class="el" href="script_8c_source.html">script.c</a>.</p>

<p>References <a class="el" href="cstr_8c_source.html#l00106">cstr_append_buf()</a>.</p>

<p>Referenced by <a class="el" href="script_8c_source.html#l00272">btc_script_append_pushdata()</a>, <a class="el" href="script_8c_source.html#l00323">btc_script_build_p2pkh()</a>, and <a class="el" href="script_8c_source.html#l00338">btc_script_build_p2sh()</a>.</p>
<div class="fragment"><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;{</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <a class="code" href="cstr_8c.html#a6633b729ade4f614afbbb8f8144fc5ad">cstr_append_buf</a>(script_in, &amp;op, 1);</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;}</div>
<div class="ttc" id="cstr_8c_html_a6633b729ade4f614afbbb8f8144fc5ad"><div class="ttname"><a href="cstr_8c.html#a6633b729ade4f614afbbb8f8144fc5ad">cstr_append_buf</a></div><div class="ttdeci">btc_bool cstr_append_buf(cstring *s, const void *buf, size_t sz)</div><div class="ttdef"><b>Definition:</b> <a href="cstr_8c_source.html#l00106">cstr.c:106</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a7a43971c43d61752153441321be1c693"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void btc_script_append_pushdata </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcstring.html">cstring</a> *&#160;</td>
          <td class="paramname"><em>script_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>datalen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="script_8c_source.html#l00272">272</a> of file <a class="el" href="script_8c_source.html">script.c</a>.</p>

<p>References <a class="el" href="script_8c_source.html#l00266">btc_script_append_op()</a>, <a class="el" href="cstr_8c_source.html#l00106">cstr_append_buf()</a>, <a class="el" href="script_8h_source.html#l00053">OP_PUSHDATA1</a>, <a class="el" href="script_8h_source.html#l00054">OP_PUSHDATA2</a>, and <a class="el" href="script_8h_source.html#l00055">OP_PUSHDATA4</a>.</p>

<p>Referenced by <a class="el" href="script_8c_source.html#l00298">btc_script_build_multisig()</a>, <a class="el" href="script_8c_source.html#l00323">btc_script_build_p2pkh()</a>, and <a class="el" href="script_8c_source.html#l00338">btc_script_build_p2sh()</a>.</p>
<div class="fragment"><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;{</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <span class="keywordflow">if</span> (datalen &lt; <a class="code" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bdaadaade1bfebdbc12e34cb1008a1c2941">OP_PUSHDATA1</a>)</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    {</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        <a class="code" href="cstr_8c.html#a6633b729ade4f614afbbb8f8144fc5ad">cstr_append_buf</a>(script_in, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)&amp;datalen, 1);</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    }</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (datalen &lt;= 0xff)</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    {</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        <a class="code" href="script_8c.html#a878362f31fcd6b422a8dade0b3addecd">btc_script_append_op</a>(script_in, <a class="code" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bdaadaade1bfebdbc12e34cb1008a1c2941">OP_PUSHDATA1</a>);</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        <a class="code" href="cstr_8c.html#a6633b729ade4f614afbbb8f8144fc5ad">cstr_append_buf</a>(script_in, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)&amp;datalen, 1);</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    }</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (datalen &lt;= 0xffff)</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    {</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        <a class="code" href="script_8c.html#a878362f31fcd6b422a8dade0b3addecd">btc_script_append_op</a>(script_in, <a class="code" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bdac494676b542e0b7fb882a72f3f42fe46">OP_PUSHDATA2</a>);</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        uint16_t v = htole16(datalen);</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        <a class="code" href="cstr_8c.html#a6633b729ade4f614afbbb8f8144fc5ad">cstr_append_buf</a>(script_in, &amp;v, <span class="keyword">sizeof</span>(v));</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    }</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    {</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        <a class="code" href="script_8c.html#a878362f31fcd6b422a8dade0b3addecd">btc_script_append_op</a>(script_in, <a class="code" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bda18ab5e1ed9ddbf9e18ea9761d12a3c02">OP_PUSHDATA4</a>);</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        uint32_t v = htole32(datalen);</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        <a class="code" href="cstr_8c.html#a6633b729ade4f614afbbb8f8144fc5ad">cstr_append_buf</a>(script_in, &amp;v, <span class="keyword">sizeof</span>(v));</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    }</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <a class="code" href="cstr_8c.html#a6633b729ade4f614afbbb8f8144fc5ad">cstr_append_buf</a>(script_in, data, datalen);</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;}</div>
<div class="ttc" id="script_8c_html_a878362f31fcd6b422a8dade0b3addecd"><div class="ttname"><a href="script_8c.html#a878362f31fcd6b422a8dade0b3addecd">btc_script_append_op</a></div><div class="ttdeci">static void btc_script_append_op(cstring *script_in, enum opcodetype op)</div><div class="ttdef"><b>Definition:</b> <a href="script_8c_source.html#l00266">script.c:266</a></div></div>
<div class="ttc" id="script_8h_html_a63e349a6089a54da9fe09a3d858648bda18ab5e1ed9ddbf9e18ea9761d12a3c02"><div class="ttname"><a href="script_8h.html#a63e349a6089a54da9fe09a3d858648bda18ab5e1ed9ddbf9e18ea9761d12a3c02">OP_PUSHDATA4</a></div><div class="ttdef"><b>Definition:</b> <a href="script_8h_source.html#l00055">script.h:55</a></div></div>
<div class="ttc" id="cstr_8c_html_a6633b729ade4f614afbbb8f8144fc5ad"><div class="ttname"><a href="cstr_8c.html#a6633b729ade4f614afbbb8f8144fc5ad">cstr_append_buf</a></div><div class="ttdeci">btc_bool cstr_append_buf(cstring *s, const void *buf, size_t sz)</div><div class="ttdef"><b>Definition:</b> <a href="cstr_8c_source.html#l00106">cstr.c:106</a></div></div>
<div class="ttc" id="script_8h_html_a63e349a6089a54da9fe09a3d858648bdac494676b542e0b7fb882a72f3f42fe46"><div class="ttname"><a href="script_8h.html#a63e349a6089a54da9fe09a3d858648bdac494676b542e0b7fb882a72f3f42fe46">OP_PUSHDATA2</a></div><div class="ttdef"><b>Definition:</b> <a href="script_8h_source.html#l00054">script.h:54</a></div></div>
<div class="ttc" id="script_8h_html_a63e349a6089a54da9fe09a3d858648bdaadaade1bfebdbc12e34cb1008a1c2941"><div class="ttname"><a href="script_8h.html#a63e349a6089a54da9fe09a3d858648bdaadaade1bfebdbc12e34cb1008a1c2941">OP_PUSHDATA1</a></div><div class="ttdef"><b>Definition:</b> <a href="script_8h_source.html#l00053">script.h:53</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a927dd82f316c4529611b91cabbd67446"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="btc_8h.html#a2426de7ad9dd5354f5e22b4c8d77e792">btc_bool</a> btc_script_build_multisig </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcstring.html">cstring</a> *&#160;</td>
          <td class="paramname"><em>script_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>required_signatures</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structvector.html">vector</a> *&#160;</td>
          <td class="paramname"><em>pubkeys_chars</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="script_8c_source.html#l00298">298</a> of file <a class="el" href="script_8c_source.html">script.c</a>.</p>

<p>References <a class="el" href="btc_8h_source.html#l00068">BTC_ECKEY_COMPRESSED_LENGTH</a>, <a class="el" href="btc_8h_source.html#l00067">BTC_ECKEY_UNCOMPRESSED_LENGTH</a>, <a class="el" href="script_8c_source.html#l00257">btc_encode_op_n()</a>, <a class="el" href="script_8c_source.html#l00272">btc_script_append_pushdata()</a>, <a class="el" href="ecc__key_8h_source.html#l00046">btc_pubkey_::compressed</a>, <a class="el" href="cstr_8c_source.html#l00106">cstr_append_buf()</a>, <a class="el" href="cstr_8c_source.html#l00081">cstr_resize()</a>, <a class="el" href="vector_8h_source.html#l00041">vector::data</a>, <a class="el" href="vector_8h_source.html#l00042">vector::len</a>, <a class="el" href="script_8h_source.html#l00167">OP_CHECKMULTISIG</a>, and <a class="el" href="ecc__key_8h_source.html#l00047">btc_pubkey_::pubkey</a>.</p>
<div class="fragment"><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;{</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <a class="code" href="cstr_8c.html#ae9bb73599cb63a84c7d535253768720d">cstr_resize</a>(script_in, 0); <span class="comment">//clear script</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="keywordflow">if</span>(required_signatures &gt; 16 || pubkeys_chars-&gt;<a class="code" href="structvector.html#abac364f9d74e0d6610c988003be1d167">len</a> &gt; 16)</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="keyword">enum</span> <a class="code" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bd">opcodetype</a> op_req_sig = <a class="code" href="script_8c.html#afaa823442c07b63492d22aabe29f7d0f">btc_encode_op_n</a>(required_signatures);</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <a class="code" href="cstr_8c.html#a6633b729ade4f614afbbb8f8144fc5ad">cstr_append_buf</a>(script_in, &amp;op_req_sig, 1);</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; (int)pubkeys_chars-&gt;<a class="code" href="structvector.html#abac364f9d74e0d6610c988003be1d167">len</a>; i++)</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    {</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        <a class="code" href="structbtc__pubkey__.html">btc_pubkey</a> *pkey = pubkeys_chars-&gt;<a class="code" href="structvector.html#a352aaf0cff9c642a2bf79d34d6d554d0">data</a>[i];</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        <a class="code" href="script_8c.html#a7a43971c43d61752153441321be1c693">btc_script_append_pushdata</a>(script_in, pkey-&gt;<a class="code" href="structbtc__pubkey__.html#a6ad765913d517a9a66c4c269c8de9953">pubkey</a>, (pkey-&gt;<a class="code" href="structbtc__pubkey__.html#a42d367287050c719027cfe467e5eaf74">compressed</a> ? <a class="code" href="btc_8h.html#ae218f7ef06647872113a6ab90c5234e5">BTC_ECKEY_COMPRESSED_LENGTH</a> : <a class="code" href="btc_8h.html#a75fb84248937512f0e50f390d94971f1">BTC_ECKEY_UNCOMPRESSED_LENGTH</a>));</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    }</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <span class="keyword">enum</span> <a class="code" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bd">opcodetype</a> op_pub_len = <a class="code" href="script_8c.html#afaa823442c07b63492d22aabe29f7d0f">btc_encode_op_n</a>(pubkeys_chars-&gt;<a class="code" href="structvector.html#abac364f9d74e0d6610c988003be1d167">len</a>);</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <a class="code" href="cstr_8c.html#a6633b729ade4f614afbbb8f8144fc5ad">cstr_append_buf</a>(script_in, &amp;op_pub_len, 1);</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <span class="keyword">enum</span> <a class="code" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bd">opcodetype</a> op_checkmultisig = <a class="code" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bda237677a3bb15c383d342aa297e7e9526">OP_CHECKMULTISIG</a>;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <a class="code" href="cstr_8c.html#a6633b729ade4f614afbbb8f8144fc5ad">cstr_append_buf</a>(script_in, &amp;op_checkmultisig, 1);</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;}</div>
<div class="ttc" id="structvector_html_a352aaf0cff9c642a2bf79d34d6d554d0"><div class="ttname"><a href="structvector.html#a352aaf0cff9c642a2bf79d34d6d554d0">vector::data</a></div><div class="ttdeci">void ** data</div><div class="ttdef"><b>Definition:</b> <a href="vector_8h_source.html#l00041">vector.h:41</a></div></div>
<div class="ttc" id="structbtc__pubkey___html"><div class="ttname"><a href="structbtc__pubkey__.html">btc_pubkey_</a></div><div class="ttdef"><b>Definition:</b> <a href="ecc__key_8h_source.html#l00044">ecc_key.h:44</a></div></div>
<div class="ttc" id="script_8c_html_a7a43971c43d61752153441321be1c693"><div class="ttname"><a href="script_8c.html#a7a43971c43d61752153441321be1c693">btc_script_append_pushdata</a></div><div class="ttdeci">static void btc_script_append_pushdata(cstring *script_in, unsigned char *data, size_t datalen)</div><div class="ttdef"><b>Definition:</b> <a href="script_8c_source.html#l00272">script.c:272</a></div></div>
<div class="ttc" id="btc_8h_html_ae218f7ef06647872113a6ab90c5234e5"><div class="ttname"><a href="btc_8h.html#ae218f7ef06647872113a6ab90c5234e5">BTC_ECKEY_COMPRESSED_LENGTH</a></div><div class="ttdeci">#define BTC_ECKEY_COMPRESSED_LENGTH</div><div class="ttdef"><b>Definition:</b> <a href="btc_8h_source.html#l00068">btc.h:68</a></div></div>
<div class="ttc" id="script_8h_html_a63e349a6089a54da9fe09a3d858648bda237677a3bb15c383d342aa297e7e9526"><div class="ttname"><a href="script_8h.html#a63e349a6089a54da9fe09a3d858648bda237677a3bb15c383d342aa297e7e9526">OP_CHECKMULTISIG</a></div><div class="ttdef"><b>Definition:</b> <a href="script_8h_source.html#l00167">script.h:167</a></div></div>
<div class="ttc" id="btc_8h_html_a75fb84248937512f0e50f390d94971f1"><div class="ttname"><a href="btc_8h.html#a75fb84248937512f0e50f390d94971f1">BTC_ECKEY_UNCOMPRESSED_LENGTH</a></div><div class="ttdeci">#define BTC_ECKEY_UNCOMPRESSED_LENGTH</div><div class="ttdef"><b>Definition:</b> <a href="btc_8h_source.html#l00067">btc.h:67</a></div></div>
<div class="ttc" id="script_8h_html_a63e349a6089a54da9fe09a3d858648bd"><div class="ttname"><a href="script_8h.html#a63e349a6089a54da9fe09a3d858648bd">opcodetype</a></div><div class="ttdeci">opcodetype</div><div class="ttdef"><b>Definition:</b> <a href="script_8h_source.html#l00049">script.h:49</a></div></div>
<div class="ttc" id="cstr_8c_html_ae9bb73599cb63a84c7d535253768720d"><div class="ttname"><a href="cstr_8c.html#ae9bb73599cb63a84c7d535253768720d">cstr_resize</a></div><div class="ttdeci">btc_bool cstr_resize(cstring *s, size_t new_sz)</div><div class="ttdef"><b>Definition:</b> <a href="cstr_8c_source.html#l00081">cstr.c:81</a></div></div>
<div class="ttc" id="script_8c_html_afaa823442c07b63492d22aabe29f7d0f"><div class="ttname"><a href="script_8c.html#afaa823442c07b63492d22aabe29f7d0f">btc_encode_op_n</a></div><div class="ttdeci">static enum opcodetype btc_encode_op_n(int n)</div><div class="ttdef"><b>Definition:</b> <a href="script_8c_source.html#l00257">script.c:257</a></div></div>
<div class="ttc" id="structvector_html_abac364f9d74e0d6610c988003be1d167"><div class="ttname"><a href="structvector.html#abac364f9d74e0d6610c988003be1d167">vector::len</a></div><div class="ttdeci">size_t len</div><div class="ttdef"><b>Definition:</b> <a href="vector_8h_source.html#l00042">vector.h:42</a></div></div>
<div class="ttc" id="structbtc__pubkey___html_a42d367287050c719027cfe467e5eaf74"><div class="ttname"><a href="structbtc__pubkey__.html#a42d367287050c719027cfe467e5eaf74">btc_pubkey_::compressed</a></div><div class="ttdeci">btc_bool compressed</div><div class="ttdef"><b>Definition:</b> <a href="ecc__key_8h_source.html#l00046">ecc_key.h:46</a></div></div>
<div class="ttc" id="cstr_8c_html_a6633b729ade4f614afbbb8f8144fc5ad"><div class="ttname"><a href="cstr_8c.html#a6633b729ade4f614afbbb8f8144fc5ad">cstr_append_buf</a></div><div class="ttdeci">btc_bool cstr_append_buf(cstring *s, const void *buf, size_t sz)</div><div class="ttdef"><b>Definition:</b> <a href="cstr_8c_source.html#l00106">cstr.c:106</a></div></div>
<div class="ttc" id="structbtc__pubkey___html_a6ad765913d517a9a66c4c269c8de9953"><div class="ttname"><a href="structbtc__pubkey__.html#a6ad765913d517a9a66c4c269c8de9953">btc_pubkey_::pubkey</a></div><div class="ttdeci">uint8_t pubkey[BTC_ECKEY_UNCOMPRESSED_LENGTH]</div><div class="ttdef"><b>Definition:</b> <a href="ecc__key_8h_source.html#l00047">ecc_key.h:47</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="acd88498494c382afb5a3b4bade4d2dc0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="btc_8h.html#a2426de7ad9dd5354f5e22b4c8d77e792">btc_bool</a> btc_script_build_p2pkh </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcstring.html">cstring</a> *&#160;</td>
          <td class="paramname"><em>script_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>hash160</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="script_8c_source.html#l00323">323</a> of file <a class="el" href="script_8c_source.html">script.c</a>.</p>

<p>References <a class="el" href="script_8c_source.html#l00266">btc_script_append_op()</a>, <a class="el" href="script_8c_source.html#l00272">btc_script_append_pushdata()</a>, <a class="el" href="cstr_8c_source.html#l00081">cstr_resize()</a>, <a class="el" href="script_8h_source.html#l00165">OP_CHECKSIG</a>, <a class="el" href="script_8h_source.html#l00100">OP_DUP</a>, <a class="el" href="script_8h_source.html#l00122">OP_EQUALVERIFY</a>, and <a class="el" href="script_8h_source.html#l00162">OP_HASH160</a>.</p>

<p>Referenced by <a class="el" href="tx_8c_source.html#l00447">btc_tx_add_p2pkh_hash160_out()</a>.</p>
<div class="fragment"><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;{</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <a class="code" href="cstr_8c.html#ae9bb73599cb63a84c7d535253768720d">cstr_resize</a>(script_in, 0); <span class="comment">//clear script</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <a class="code" href="script_8c.html#a878362f31fcd6b422a8dade0b3addecd">btc_script_append_op</a>(script_in, <a class="code" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bda47360cbb2e673baa31591adbb153c9b3">OP_DUP</a>);</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <a class="code" href="script_8c.html#a878362f31fcd6b422a8dade0b3addecd">btc_script_append_op</a>(script_in, <a class="code" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bda73c89133f3d2bdf12ac1ec91e06ba3cd">OP_HASH160</a>);</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <a class="code" href="script_8c.html#a7a43971c43d61752153441321be1c693">btc_script_append_pushdata</a>(script_in, hash160, 20);</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <a class="code" href="script_8c.html#a878362f31fcd6b422a8dade0b3addecd">btc_script_append_op</a>(script_in, <a class="code" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bdae24d4b553a43d3d57bbac4d9bd4bdf24">OP_EQUALVERIFY</a>);</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <a class="code" href="script_8c.html#a878362f31fcd6b422a8dade0b3addecd">btc_script_append_op</a>(script_in, <a class="code" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bda2c190c5caf052f92d3d9ac31a0d96151">OP_CHECKSIG</a>);</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;}</div>
<div class="ttc" id="script_8h_html_a63e349a6089a54da9fe09a3d858648bdae24d4b553a43d3d57bbac4d9bd4bdf24"><div class="ttname"><a href="script_8h.html#a63e349a6089a54da9fe09a3d858648bdae24d4b553a43d3d57bbac4d9bd4bdf24">OP_EQUALVERIFY</a></div><div class="ttdef"><b>Definition:</b> <a href="script_8h_source.html#l00122">script.h:122</a></div></div>
<div class="ttc" id="script_8h_html_a63e349a6089a54da9fe09a3d858648bda2c190c5caf052f92d3d9ac31a0d96151"><div class="ttname"><a href="script_8h.html#a63e349a6089a54da9fe09a3d858648bda2c190c5caf052f92d3d9ac31a0d96151">OP_CHECKSIG</a></div><div class="ttdef"><b>Definition:</b> <a href="script_8h_source.html#l00165">script.h:165</a></div></div>
<div class="ttc" id="script_8c_html_a7a43971c43d61752153441321be1c693"><div class="ttname"><a href="script_8c.html#a7a43971c43d61752153441321be1c693">btc_script_append_pushdata</a></div><div class="ttdeci">static void btc_script_append_pushdata(cstring *script_in, unsigned char *data, size_t datalen)</div><div class="ttdef"><b>Definition:</b> <a href="script_8c_source.html#l00272">script.c:272</a></div></div>
<div class="ttc" id="script_8h_html_a63e349a6089a54da9fe09a3d858648bda73c89133f3d2bdf12ac1ec91e06ba3cd"><div class="ttname"><a href="script_8h.html#a63e349a6089a54da9fe09a3d858648bda73c89133f3d2bdf12ac1ec91e06ba3cd">OP_HASH160</a></div><div class="ttdef"><b>Definition:</b> <a href="script_8h_source.html#l00162">script.h:162</a></div></div>
<div class="ttc" id="cstr_8c_html_ae9bb73599cb63a84c7d535253768720d"><div class="ttname"><a href="cstr_8c.html#ae9bb73599cb63a84c7d535253768720d">cstr_resize</a></div><div class="ttdeci">btc_bool cstr_resize(cstring *s, size_t new_sz)</div><div class="ttdef"><b>Definition:</b> <a href="cstr_8c_source.html#l00081">cstr.c:81</a></div></div>
<div class="ttc" id="script_8c_html_a878362f31fcd6b422a8dade0b3addecd"><div class="ttname"><a href="script_8c.html#a878362f31fcd6b422a8dade0b3addecd">btc_script_append_op</a></div><div class="ttdeci">static void btc_script_append_op(cstring *script_in, enum opcodetype op)</div><div class="ttdef"><b>Definition:</b> <a href="script_8c_source.html#l00266">script.c:266</a></div></div>
<div class="ttc" id="script_8h_html_a63e349a6089a54da9fe09a3d858648bda47360cbb2e673baa31591adbb153c9b3"><div class="ttname"><a href="script_8h.html#a63e349a6089a54da9fe09a3d858648bda47360cbb2e673baa31591adbb153c9b3">OP_DUP</a></div><div class="ttdef"><b>Definition:</b> <a href="script_8h_source.html#l00100">script.h:100</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad4794b5e3110aca0d40f6bc042c0561c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="btc_8h.html#a2426de7ad9dd5354f5e22b4c8d77e792">btc_bool</a> btc_script_build_p2sh </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcstring.html">cstring</a> *&#160;</td>
          <td class="paramname"><em>script_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>hash160</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="script_8c_source.html#l00338">338</a> of file <a class="el" href="script_8c_source.html">script.c</a>.</p>

<p>References <a class="el" href="script_8c_source.html#l00266">btc_script_append_op()</a>, <a class="el" href="script_8c_source.html#l00272">btc_script_append_pushdata()</a>, <a class="el" href="cstr_8c_source.html#l00081">cstr_resize()</a>, <a class="el" href="script_8h_source.html#l00121">OP_EQUAL</a>, and <a class="el" href="script_8h_source.html#l00162">OP_HASH160</a>.</p>

<p>Referenced by <a class="el" href="tx_8c_source.html#l00461">btc_tx_add_p2sh_hash160_out()</a>.</p>
<div class="fragment"><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;{</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <a class="code" href="cstr_8c.html#ae9bb73599cb63a84c7d535253768720d">cstr_resize</a>(script_in, 0); <span class="comment">//clear script</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <a class="code" href="script_8c.html#a878362f31fcd6b422a8dade0b3addecd">btc_script_append_op</a>(script_in, <a class="code" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bda73c89133f3d2bdf12ac1ec91e06ba3cd">OP_HASH160</a>);</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <a class="code" href="script_8c.html#a7a43971c43d61752153441321be1c693">btc_script_append_pushdata</a>(script_in, hash160, 20);</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <a class="code" href="script_8c.html#a878362f31fcd6b422a8dade0b3addecd">btc_script_append_op</a>(script_in, <a class="code" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bda383e0c5476b2ddc1839af951b393ca17">OP_EQUAL</a>);</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;}</div>
<div class="ttc" id="script_8c_html_a7a43971c43d61752153441321be1c693"><div class="ttname"><a href="script_8c.html#a7a43971c43d61752153441321be1c693">btc_script_append_pushdata</a></div><div class="ttdeci">static void btc_script_append_pushdata(cstring *script_in, unsigned char *data, size_t datalen)</div><div class="ttdef"><b>Definition:</b> <a href="script_8c_source.html#l00272">script.c:272</a></div></div>
<div class="ttc" id="script_8h_html_a63e349a6089a54da9fe09a3d858648bda73c89133f3d2bdf12ac1ec91e06ba3cd"><div class="ttname"><a href="script_8h.html#a63e349a6089a54da9fe09a3d858648bda73c89133f3d2bdf12ac1ec91e06ba3cd">OP_HASH160</a></div><div class="ttdef"><b>Definition:</b> <a href="script_8h_source.html#l00162">script.h:162</a></div></div>
<div class="ttc" id="cstr_8c_html_ae9bb73599cb63a84c7d535253768720d"><div class="ttname"><a href="cstr_8c.html#ae9bb73599cb63a84c7d535253768720d">cstr_resize</a></div><div class="ttdeci">btc_bool cstr_resize(cstring *s, size_t new_sz)</div><div class="ttdef"><b>Definition:</b> <a href="cstr_8c_source.html#l00081">cstr.c:81</a></div></div>
<div class="ttc" id="script_8c_html_a878362f31fcd6b422a8dade0b3addecd"><div class="ttname"><a href="script_8c.html#a878362f31fcd6b422a8dade0b3addecd">btc_script_append_op</a></div><div class="ttdeci">static void btc_script_append_op(cstring *script_in, enum opcodetype op)</div><div class="ttdef"><b>Definition:</b> <a href="script_8c_source.html#l00266">script.c:266</a></div></div>
<div class="ttc" id="script_8h_html_a63e349a6089a54da9fe09a3d858648bda383e0c5476b2ddc1839af951b393ca17"><div class="ttname"><a href="script_8h.html#a63e349a6089a54da9fe09a3d858648bda383e0c5476b2ddc1839af951b393ca17">OP_EQUAL</a></div><div class="ttdef"><b>Definition:</b> <a href="script_8h_source.html#l00121">script.h:121</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4a2cb7d490cc914cffa99a84c140c435"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="script_8h.html#a517c02233134e7b8b6ae330184b28b49">btc_tx_out_type</a> btc_script_classify </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvector.html">vector</a> *&#160;</td>
          <td class="paramname"><em>ops</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="script_8c_source.html#l00243">243</a> of file <a class="el" href="script_8c_source.html">script.c</a>.</p>

<p>References <a class="el" href="script_8c_source.html#l00227">btc_script_is_multisig()</a>, <a class="el" href="script_8c_source.html#l00194">btc_script_is_pubkey()</a>, <a class="el" href="script_8c_source.html#l00202">btc_script_is_pubkeyhash()</a>, <a class="el" href="script_8c_source.html#l00213">btc_script_is_scripthash()</a>, <a class="el" href="script_8h_source.html#l00199">BTC_TX_MULTISIG</a>, <a class="el" href="script_8h_source.html#l00194">BTC_TX_NONSTANDARD</a>, <a class="el" href="script_8h_source.html#l00196">BTC_TX_PUBKEY</a>, <a class="el" href="script_8h_source.html#l00197">BTC_TX_PUBKEYHASH</a>, and <a class="el" href="script_8h_source.html#l00198">BTC_TX_SCRIPTHASH</a>.</p>
<div class="fragment"><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;{</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="script_8c.html#a104cab956788e243c00e157372d852d4">btc_script_is_pubkeyhash</a>(ops))</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="script_8h.html#a517c02233134e7b8b6ae330184b28b49a7af55b9a7c250501662bd499dc18a53c">BTC_TX_PUBKEYHASH</a>;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="script_8c.html#a702b03d4e597b5d6ccdda6c15fd472e0">btc_script_is_scripthash</a>(ops))</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="script_8h.html#a517c02233134e7b8b6ae330184b28b49ac27529348a9df4650f0bba52d2557556">BTC_TX_SCRIPTHASH</a>;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="script_8c.html#a992fde7b9a8b9178e70337fe7646d813">btc_script_is_pubkey</a>(ops))</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="script_8h.html#a517c02233134e7b8b6ae330184b28b49aaf43a799483bd5121e3ef3750213343c">BTC_TX_PUBKEY</a>;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="script_8c.html#ab366c5b2c8adcdff51bb6776bec934a3">btc_script_is_multisig</a>(ops))</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="script_8h.html#a517c02233134e7b8b6ae330184b28b49afacc953c46e0ee001822241829580d99">BTC_TX_MULTISIG</a>;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="script_8h.html#a517c02233134e7b8b6ae330184b28b49a9a36c9d9acf89e32ae8113f5621c98cb">BTC_TX_NONSTANDARD</a>;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;}</div>
<div class="ttc" id="script_8h_html_a517c02233134e7b8b6ae330184b28b49aaf43a799483bd5121e3ef3750213343c"><div class="ttname"><a href="script_8h.html#a517c02233134e7b8b6ae330184b28b49aaf43a799483bd5121e3ef3750213343c">BTC_TX_PUBKEY</a></div><div class="ttdef"><b>Definition:</b> <a href="script_8h_source.html#l00196">script.h:196</a></div></div>
<div class="ttc" id="script_8h_html_a517c02233134e7b8b6ae330184b28b49a7af55b9a7c250501662bd499dc18a53c"><div class="ttname"><a href="script_8h.html#a517c02233134e7b8b6ae330184b28b49a7af55b9a7c250501662bd499dc18a53c">BTC_TX_PUBKEYHASH</a></div><div class="ttdef"><b>Definition:</b> <a href="script_8h_source.html#l00197">script.h:197</a></div></div>
<div class="ttc" id="script_8c_html_a702b03d4e597b5d6ccdda6c15fd472e0"><div class="ttname"><a href="script_8c.html#a702b03d4e597b5d6ccdda6c15fd472e0">btc_script_is_scripthash</a></div><div class="ttdeci">btc_bool btc_script_is_scripthash(vector *ops)</div><div class="ttdef"><b>Definition:</b> <a href="script_8c_source.html#l00213">script.c:213</a></div></div>
<div class="ttc" id="script_8c_html_ab366c5b2c8adcdff51bb6776bec934a3"><div class="ttname"><a href="script_8c.html#ab366c5b2c8adcdff51bb6776bec934a3">btc_script_is_multisig</a></div><div class="ttdeci">btc_bool btc_script_is_multisig(vector *ops)</div><div class="ttdef"><b>Definition:</b> <a href="script_8c_source.html#l00227">script.c:227</a></div></div>
<div class="ttc" id="script_8c_html_a992fde7b9a8b9178e70337fe7646d813"><div class="ttname"><a href="script_8c.html#a992fde7b9a8b9178e70337fe7646d813">btc_script_is_pubkey</a></div><div class="ttdeci">btc_bool btc_script_is_pubkey(vector *ops)</div><div class="ttdef"><b>Definition:</b> <a href="script_8c_source.html#l00194">script.c:194</a></div></div>
<div class="ttc" id="script_8h_html_a517c02233134e7b8b6ae330184b28b49ac27529348a9df4650f0bba52d2557556"><div class="ttname"><a href="script_8h.html#a517c02233134e7b8b6ae330184b28b49ac27529348a9df4650f0bba52d2557556">BTC_TX_SCRIPTHASH</a></div><div class="ttdef"><b>Definition:</b> <a href="script_8h_source.html#l00198">script.h:198</a></div></div>
<div class="ttc" id="script_8h_html_a517c02233134e7b8b6ae330184b28b49a9a36c9d9acf89e32ae8113f5621c98cb"><div class="ttname"><a href="script_8h.html#a517c02233134e7b8b6ae330184b28b49a9a36c9d9acf89e32ae8113f5621c98cb">BTC_TX_NONSTANDARD</a></div><div class="ttdef"><b>Definition:</b> <a href="script_8h_source.html#l00194">script.h:194</a></div></div>
<div class="ttc" id="script_8h_html_a517c02233134e7b8b6ae330184b28b49afacc953c46e0ee001822241829580d99"><div class="ttname"><a href="script_8h.html#a517c02233134e7b8b6ae330184b28b49afacc953c46e0ee001822241829580d99">BTC_TX_MULTISIG</a></div><div class="ttdef"><b>Definition:</b> <a href="script_8h_source.html#l00199">script.h:199</a></div></div>
<div class="ttc" id="script_8c_html_a104cab956788e243c00e157372d852d4"><div class="ttname"><a href="script_8c.html#a104cab956788e243c00e157372d852d4">btc_script_is_pubkeyhash</a></div><div class="ttdeci">btc_bool btc_script_is_pubkeyhash(vector *ops)</div><div class="ttdef"><b>Definition:</b> <a href="script_8c_source.html#l00202">script.c:202</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9dd34db16bd8f086717ce69df799d7f7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="btc_8h.html#a2426de7ad9dd5354f5e22b4c8d77e792">btc_bool</a> btc_script_copy_without_op_codeseperator </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structcstring.html">cstring</a> *&#160;</td>
          <td class="paramname"><em>script_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcstring.html">cstring</a> *&#160;</td>
          <td class="paramname"><em>script_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="script_8c_source.html#l00036">36</a> of file <a class="el" href="script_8c_source.html">script.c</a>.</p>

<p>References <a class="el" href="cstr_8c_source.html#l00106">cstr_append_buf()</a>, <a class="el" href="serialize_8c_source.html#l00103">deser_bytes()</a>, <a class="el" href="serialize_8c_source.html#l00092">deser_skip()</a>, <a class="el" href="serialize_8c_source.html#l00115">deser_u16()</a>, <a class="el" href="serialize_8c_source.html#l00126">deser_u32()</a>, <a class="el" href="buffer_8h_source.html#l00022">const_buffer::len</a>, <a class="el" href="cstr_8h_source.html#l00044">cstring::len</a>, <a class="el" href="script_8h_source.html#l00164">OP_CODESEPARATOR</a>, <a class="el" href="script_8h_source.html#l00053">OP_PUSHDATA1</a>, <a class="el" href="script_8h_source.html#l00054">OP_PUSHDATA2</a>, <a class="el" href="script_8h_source.html#l00055">OP_PUSHDATA4</a>, <a class="el" href="buffer_8h_source.html#l00021">const_buffer::p</a>, and <a class="el" href="cstr_8h_source.html#l00043">cstring::str</a>.</p>

<p>Referenced by <a class="el" href="tx_8c_source.html#l00330">btc_tx_sighash()</a>.</p>
<div class="fragment"><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;{</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <span class="keywordflow">if</span> (script_in-&gt;<a class="code" href="structcstring.html#ad0eb3a0fea291824cc3a7176a4d6a345">len</a> == 0)</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">/* EOF */</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="keyword">struct </span><a class="code" href="structconst__buffer.html">const_buffer</a> buf = {script_in-&gt;<a class="code" href="structcstring.html#a731cdf51b981dfd0c66713e2c942a43d">str</a>, script_in-&gt;<a class="code" href="structcstring.html#ad0eb3a0fea291824cc3a7176a4d6a345">len</a>};</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> opcode;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="keywordflow">while</span> (buf.<a class="code" href="structconst__buffer.html#aeea2fa428f380d27375680cc0d7d9952">len</a> &gt; 0) {</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="serialize_8c.html#a073fdf7c88cbb00c955587ea4bc93d19">deser_bytes</a>(&amp;opcode, &amp;buf, 1))</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;            <span class="keywordflow">goto</span> err_out;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        uint32_t data_len;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        <span class="keywordflow">if</span> (opcode == <a class="code" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bda57d43cf2c1d702fa2eae9c97f00dd0d9">OP_CODESEPARATOR</a>)</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (opcode == <a class="code" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bdaadaade1bfebdbc12e34cb1008a1c2941">OP_PUSHDATA1</a>) {</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;            uint8_t v8;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="serialize_8c.html#a073fdf7c88cbb00c955587ea4bc93d19">deser_bytes</a>(&amp;v8, &amp;buf, 1))</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;                <span class="keywordflow">goto</span> err_out;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;            data_len = v8;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (opcode == <a class="code" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bdac494676b542e0b7fb882a72f3f42fe46">OP_PUSHDATA2</a>) {</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;            uint16_t v16;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="serialize_8c.html#a970f3214047ee9cdfa00ea62012ab874">deser_u16</a>(&amp;v16, &amp;buf))</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;                <span class="keywordflow">goto</span> err_out;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;            data_len = v16;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (opcode == <a class="code" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bda18ab5e1ed9ddbf9e18ea9761d12a3c02">OP_PUSHDATA4</a>) {</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;            uint32_t v32;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="serialize_8c.html#a9f08283b7be4f3188c34845e4cce5cc5">deser_u32</a>(&amp;v32, &amp;buf))</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;                <span class="keywordflow">goto</span> err_out;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;            data_len = v32;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;            <a class="code" href="cstr_8c.html#a6633b729ade4f614afbbb8f8144fc5ad">cstr_append_buf</a>(script_out, &amp;opcode, 1);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        }</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        <a class="code" href="cstr_8c.html#a6633b729ade4f614afbbb8f8144fc5ad">cstr_append_buf</a>(script_out, buf.<a class="code" href="structconst__buffer.html#a0f8f88d516b9e6a9088aa7927b780f01">p</a>, data_len);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="serialize_8c.html#aa7c87083d997ada0db91711f7621bcee">deser_skip</a>(&amp;buf, data_len))</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;            <span class="keywordflow">goto</span> err_out;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    }</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;err_out:</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;}</div>
<div class="ttc" id="structcstring_html_a731cdf51b981dfd0c66713e2c942a43d"><div class="ttname"><a href="structcstring.html#a731cdf51b981dfd0c66713e2c942a43d">cstring::str</a></div><div class="ttdeci">char * str</div><div class="ttdef"><b>Definition:</b> <a href="cstr_8h_source.html#l00043">cstr.h:43</a></div></div>
<div class="ttc" id="structconst__buffer_html_aeea2fa428f380d27375680cc0d7d9952"><div class="ttname"><a href="structconst__buffer.html#aeea2fa428f380d27375680cc0d7d9952">const_buffer::len</a></div><div class="ttdeci">size_t len</div><div class="ttdef"><b>Definition:</b> <a href="buffer_8h_source.html#l00022">buffer.h:22</a></div></div>
<div class="ttc" id="serialize_8c_html_aa7c87083d997ada0db91711f7621bcee"><div class="ttname"><a href="serialize_8c.html#aa7c87083d997ada0db91711f7621bcee">deser_skip</a></div><div class="ttdeci">btc_bool deser_skip(struct const_buffer *buf, size_t len)</div><div class="ttdef"><b>Definition:</b> <a href="serialize_8c_source.html#l00092">serialize.c:92</a></div></div>
<div class="ttc" id="structconst__buffer_html_a0f8f88d516b9e6a9088aa7927b780f01"><div class="ttname"><a href="structconst__buffer.html#a0f8f88d516b9e6a9088aa7927b780f01">const_buffer::p</a></div><div class="ttdeci">const void * p</div><div class="ttdef"><b>Definition:</b> <a href="buffer_8h_source.html#l00021">buffer.h:21</a></div></div>
<div class="ttc" id="serialize_8c_html_a9f08283b7be4f3188c34845e4cce5cc5"><div class="ttname"><a href="serialize_8c.html#a9f08283b7be4f3188c34845e4cce5cc5">deser_u32</a></div><div class="ttdeci">btc_bool deser_u32(uint32_t *vo, struct const_buffer *buf)</div><div class="ttdef"><b>Definition:</b> <a href="serialize_8c_source.html#l00126">serialize.c:126</a></div></div>
<div class="ttc" id="serialize_8c_html_a073fdf7c88cbb00c955587ea4bc93d19"><div class="ttname"><a href="serialize_8c.html#a073fdf7c88cbb00c955587ea4bc93d19">deser_bytes</a></div><div class="ttdeci">btc_bool deser_bytes(void *po, struct const_buffer *buf, size_t len)</div><div class="ttdef"><b>Definition:</b> <a href="serialize_8c_source.html#l00103">serialize.c:103</a></div></div>
<div class="ttc" id="serialize_8c_html_a970f3214047ee9cdfa00ea62012ab874"><div class="ttname"><a href="serialize_8c.html#a970f3214047ee9cdfa00ea62012ab874">deser_u16</a></div><div class="ttdeci">btc_bool deser_u16(uint16_t *vo, struct const_buffer *buf)</div><div class="ttdef"><b>Definition:</b> <a href="serialize_8c_source.html#l00115">serialize.c:115</a></div></div>
<div class="ttc" id="structcstring_html_ad0eb3a0fea291824cc3a7176a4d6a345"><div class="ttname"><a href="structcstring.html#ad0eb3a0fea291824cc3a7176a4d6a345">cstring::len</a></div><div class="ttdeci">size_t len</div><div class="ttdef"><b>Definition:</b> <a href="cstr_8h_source.html#l00044">cstr.h:44</a></div></div>
<div class="ttc" id="script_8h_html_a63e349a6089a54da9fe09a3d858648bda18ab5e1ed9ddbf9e18ea9761d12a3c02"><div class="ttname"><a href="script_8h.html#a63e349a6089a54da9fe09a3d858648bda18ab5e1ed9ddbf9e18ea9761d12a3c02">OP_PUSHDATA4</a></div><div class="ttdef"><b>Definition:</b> <a href="script_8h_source.html#l00055">script.h:55</a></div></div>
<div class="ttc" id="script_8h_html_a63e349a6089a54da9fe09a3d858648bda57d43cf2c1d702fa2eae9c97f00dd0d9"><div class="ttname"><a href="script_8h.html#a63e349a6089a54da9fe09a3d858648bda57d43cf2c1d702fa2eae9c97f00dd0d9">OP_CODESEPARATOR</a></div><div class="ttdef"><b>Definition:</b> <a href="script_8h_source.html#l00164">script.h:164</a></div></div>
<div class="ttc" id="cstr_8c_html_a6633b729ade4f614afbbb8f8144fc5ad"><div class="ttname"><a href="cstr_8c.html#a6633b729ade4f614afbbb8f8144fc5ad">cstr_append_buf</a></div><div class="ttdeci">btc_bool cstr_append_buf(cstring *s, const void *buf, size_t sz)</div><div class="ttdef"><b>Definition:</b> <a href="cstr_8c_source.html#l00106">cstr.c:106</a></div></div>
<div class="ttc" id="structconst__buffer_html"><div class="ttname"><a href="structconst__buffer.html">const_buffer</a></div><div class="ttdef"><b>Definition:</b> <a href="buffer_8h_source.html#l00019">buffer.h:19</a></div></div>
<div class="ttc" id="script_8h_html_a63e349a6089a54da9fe09a3d858648bdac494676b542e0b7fb882a72f3f42fe46"><div class="ttname"><a href="script_8h.html#a63e349a6089a54da9fe09a3d858648bdac494676b542e0b7fb882a72f3f42fe46">OP_PUSHDATA2</a></div><div class="ttdef"><b>Definition:</b> <a href="script_8h_source.html#l00054">script.h:54</a></div></div>
<div class="ttc" id="script_8h_html_a63e349a6089a54da9fe09a3d858648bdaadaade1bfebdbc12e34cb1008a1c2941"><div class="ttname"><a href="script_8h.html#a63e349a6089a54da9fe09a3d858648bdaadaade1bfebdbc12e34cb1008a1c2941">OP_PUSHDATA1</a></div><div class="ttdef"><b>Definition:</b> <a href="script_8h_source.html#l00053">script.h:53</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a69ef4e31bc44eb4f4c90ea975ce71d44"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="btc_8h.html#a2426de7ad9dd5354f5e22b4c8d77e792">btc_bool</a> btc_script_get_ops </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structcstring.html">cstring</a> *&#160;</td>
          <td class="paramname"><em>script_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structvector.html">vector</a> *&#160;</td>
          <td class="paramname"><em>ops_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="script_8c_source.html#l00108">108</a> of file <a class="el" href="script_8c_source.html">script.c</a>.</p>

<p>References <a class="el" href="script_8c_source.html#l00090">btc_script_op_free()</a>, <a class="el" href="script_8c_source.html#l00081">btc_script_op_new()</a>, <a class="el" href="script_8h_source.html#l00205">btc_script_op_::data</a>, <a class="el" href="script_8h_source.html#l00206">btc_script_op_::datalen</a>, <a class="el" href="serialize_8c_source.html#l00103">deser_bytes()</a>, <a class="el" href="serialize_8c_source.html#l00092">deser_skip()</a>, <a class="el" href="serialize_8c_source.html#l00115">deser_u16()</a>, <a class="el" href="serialize_8c_source.html#l00126">deser_u32()</a>, <a class="el" href="buffer_8h_source.html#l00022">const_buffer::len</a>, <a class="el" href="cstr_8h_source.html#l00044">cstring::len</a>, <a class="el" href="script_8h_source.html#l00204">btc_script_op_::op</a>, <a class="el" href="script_8h_source.html#l00053">OP_PUSHDATA1</a>, <a class="el" href="script_8h_source.html#l00054">OP_PUSHDATA2</a>, <a class="el" href="script_8h_source.html#l00055">OP_PUSHDATA4</a>, <a class="el" href="buffer_8h_source.html#l00021">const_buffer::p</a>, <a class="el" href="cstr_8h_source.html#l00043">cstring::str</a>, and <a class="el" href="vector_8c_source.html#l00113">vector_add()</a>.</p>
<div class="fragment"><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;{</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="keywordflow">if</span> (script_in-&gt;<a class="code" href="structcstring.html#ad0eb3a0fea291824cc3a7176a4d6a345">len</a> == 0)</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">/* EOF */</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="keyword">struct </span><a class="code" href="structconst__buffer.html">const_buffer</a> buf = {script_in-&gt;<a class="code" href="structcstring.html#a731cdf51b981dfd0c66713e2c942a43d">str</a>, script_in-&gt;<a class="code" href="structcstring.html#ad0eb3a0fea291824cc3a7176a4d6a345">len</a>};</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> opcode;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <a class="code" href="structbtc__script__op__.html">btc_script_op</a>* op = NULL;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="keywordflow">while</span> (buf.<a class="code" href="structconst__buffer.html#aeea2fa428f380d27375680cc0d7d9952">len</a> &gt; 0) {</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        op = <a class="code" href="script_8c.html#a3701ef637831f94ec0bde2da6920cc56">btc_script_op_new</a>();</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="serialize_8c.html#a073fdf7c88cbb00c955587ea4bc93d19">deser_bytes</a>(&amp;opcode, &amp;buf, 1))</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;            <span class="keywordflow">goto</span> err_out;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        op-&gt;<a class="code" href="structbtc__script__op__.html#a5d4882886c8cd495f6c71ee82328fa6b">op</a> = opcode;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        uint32_t data_len;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        <span class="keywordflow">if</span> (opcode &lt; <a class="code" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bdaadaade1bfebdbc12e34cb1008a1c2941">OP_PUSHDATA1</a>) {</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;            data_len = opcode;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (opcode == <a class="code" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bdaadaade1bfebdbc12e34cb1008a1c2941">OP_PUSHDATA1</a>) {</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;            uint8_t v8;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="serialize_8c.html#a073fdf7c88cbb00c955587ea4bc93d19">deser_bytes</a>(&amp;v8, &amp;buf, 1))</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                <span class="keywordflow">goto</span> err_out;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;            data_len = v8;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (opcode == <a class="code" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bdac494676b542e0b7fb882a72f3f42fe46">OP_PUSHDATA2</a>) {</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;            uint16_t v16;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="serialize_8c.html#a970f3214047ee9cdfa00ea62012ab874">deser_u16</a>(&amp;v16, &amp;buf))</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                <span class="keywordflow">goto</span> err_out;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;            data_len = v16;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (opcode == <a class="code" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bda18ab5e1ed9ddbf9e18ea9761d12a3c02">OP_PUSHDATA4</a>) {</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;            uint32_t v32;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="serialize_8c.html#a9f08283b7be4f3188c34845e4cce5cc5">deser_u32</a>(&amp;v32, &amp;buf))</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                <span class="keywordflow">goto</span> err_out;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;            data_len = v32;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;            <a class="code" href="vector_8c.html#a8134375d5d89f3832b9967e98fe75de5">vector_add</a>(ops_out, op);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        }</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        op-&gt;<a class="code" href="structbtc__script__op__.html#a55d375615cf71b0f3d5876c26acd1485">data</a> = calloc(1, data_len);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        memcpy(op-&gt;<a class="code" href="structbtc__script__op__.html#a55d375615cf71b0f3d5876c26acd1485">data</a>, &amp;buf.<a class="code" href="structconst__buffer.html#a0f8f88d516b9e6a9088aa7927b780f01">p</a>, data_len);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        op-&gt;<a class="code" href="structbtc__script__op__.html#a98d61935f3bd0ad810dbcb8e1f459f72">datalen</a> = data_len;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        <a class="code" href="vector_8c.html#a8134375d5d89f3832b9967e98fe75de5">vector_add</a>(ops_out, op);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="serialize_8c.html#aa7c87083d997ada0db91711f7621bcee">deser_skip</a>(&amp;buf, data_len))</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;            <span class="keywordflow">goto</span> err_out;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    }</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;err_out:</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <a class="code" href="script_8c.html#aea847aa69db6d03ee2eca62a0422c12e">btc_script_op_free</a>(op);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;}</div>
<div class="ttc" id="structcstring_html_a731cdf51b981dfd0c66713e2c942a43d"><div class="ttname"><a href="structcstring.html#a731cdf51b981dfd0c66713e2c942a43d">cstring::str</a></div><div class="ttdeci">char * str</div><div class="ttdef"><b>Definition:</b> <a href="cstr_8h_source.html#l00043">cstr.h:43</a></div></div>
<div class="ttc" id="structconst__buffer_html_aeea2fa428f380d27375680cc0d7d9952"><div class="ttname"><a href="structconst__buffer.html#aeea2fa428f380d27375680cc0d7d9952">const_buffer::len</a></div><div class="ttdeci">size_t len</div><div class="ttdef"><b>Definition:</b> <a href="buffer_8h_source.html#l00022">buffer.h:22</a></div></div>
<div class="ttc" id="serialize_8c_html_aa7c87083d997ada0db91711f7621bcee"><div class="ttname"><a href="serialize_8c.html#aa7c87083d997ada0db91711f7621bcee">deser_skip</a></div><div class="ttdeci">btc_bool deser_skip(struct const_buffer *buf, size_t len)</div><div class="ttdef"><b>Definition:</b> <a href="serialize_8c_source.html#l00092">serialize.c:92</a></div></div>
<div class="ttc" id="script_8c_html_a3701ef637831f94ec0bde2da6920cc56"><div class="ttname"><a href="script_8c.html#a3701ef637831f94ec0bde2da6920cc56">btc_script_op_new</a></div><div class="ttdeci">btc_script_op * btc_script_op_new()</div><div class="ttdef"><b>Definition:</b> <a href="script_8c_source.html#l00081">script.c:81</a></div></div>
<div class="ttc" id="structbtc__script__op___html_a98d61935f3bd0ad810dbcb8e1f459f72"><div class="ttname"><a href="structbtc__script__op__.html#a98d61935f3bd0ad810dbcb8e1f459f72">btc_script_op_::datalen</a></div><div class="ttdeci">size_t datalen</div><div class="ttdef"><b>Definition:</b> <a href="script_8h_source.html#l00206">script.h:206</a></div></div>
<div class="ttc" id="structconst__buffer_html_a0f8f88d516b9e6a9088aa7927b780f01"><div class="ttname"><a href="structconst__buffer.html#a0f8f88d516b9e6a9088aa7927b780f01">const_buffer::p</a></div><div class="ttdeci">const void * p</div><div class="ttdef"><b>Definition:</b> <a href="buffer_8h_source.html#l00021">buffer.h:21</a></div></div>
<div class="ttc" id="serialize_8c_html_a9f08283b7be4f3188c34845e4cce5cc5"><div class="ttname"><a href="serialize_8c.html#a9f08283b7be4f3188c34845e4cce5cc5">deser_u32</a></div><div class="ttdeci">btc_bool deser_u32(uint32_t *vo, struct const_buffer *buf)</div><div class="ttdef"><b>Definition:</b> <a href="serialize_8c_source.html#l00126">serialize.c:126</a></div></div>
<div class="ttc" id="script_8c_html_aea847aa69db6d03ee2eca62a0422c12e"><div class="ttname"><a href="script_8c.html#aea847aa69db6d03ee2eca62a0422c12e">btc_script_op_free</a></div><div class="ttdeci">void btc_script_op_free(btc_script_op *script_op)</div><div class="ttdef"><b>Definition:</b> <a href="script_8c_source.html#l00090">script.c:90</a></div></div>
<div class="ttc" id="serialize_8c_html_a073fdf7c88cbb00c955587ea4bc93d19"><div class="ttname"><a href="serialize_8c.html#a073fdf7c88cbb00c955587ea4bc93d19">deser_bytes</a></div><div class="ttdeci">btc_bool deser_bytes(void *po, struct const_buffer *buf, size_t len)</div><div class="ttdef"><b>Definition:</b> <a href="serialize_8c_source.html#l00103">serialize.c:103</a></div></div>
<div class="ttc" id="vector_8c_html_a8134375d5d89f3832b9967e98fe75de5"><div class="ttname"><a href="vector_8c.html#a8134375d5d89f3832b9967e98fe75de5">vector_add</a></div><div class="ttdeci">btc_bool vector_add(vector *vec, void *data)</div><div class="ttdef"><b>Definition:</b> <a href="vector_8c_source.html#l00113">vector.c:113</a></div></div>
<div class="ttc" id="serialize_8c_html_a970f3214047ee9cdfa00ea62012ab874"><div class="ttname"><a href="serialize_8c.html#a970f3214047ee9cdfa00ea62012ab874">deser_u16</a></div><div class="ttdeci">btc_bool deser_u16(uint16_t *vo, struct const_buffer *buf)</div><div class="ttdef"><b>Definition:</b> <a href="serialize_8c_source.html#l00115">serialize.c:115</a></div></div>
<div class="ttc" id="structcstring_html_ad0eb3a0fea291824cc3a7176a4d6a345"><div class="ttname"><a href="structcstring.html#ad0eb3a0fea291824cc3a7176a4d6a345">cstring::len</a></div><div class="ttdeci">size_t len</div><div class="ttdef"><b>Definition:</b> <a href="cstr_8h_source.html#l00044">cstr.h:44</a></div></div>
<div class="ttc" id="structbtc__script__op___html"><div class="ttname"><a href="structbtc__script__op__.html">btc_script_op_</a></div><div class="ttdef"><b>Definition:</b> <a href="script_8h_source.html#l00202">script.h:202</a></div></div>
<div class="ttc" id="script_8h_html_a63e349a6089a54da9fe09a3d858648bda18ab5e1ed9ddbf9e18ea9761d12a3c02"><div class="ttname"><a href="script_8h.html#a63e349a6089a54da9fe09a3d858648bda18ab5e1ed9ddbf9e18ea9761d12a3c02">OP_PUSHDATA4</a></div><div class="ttdef"><b>Definition:</b> <a href="script_8h_source.html#l00055">script.h:55</a></div></div>
<div class="ttc" id="structbtc__script__op___html_a5d4882886c8cd495f6c71ee82328fa6b"><div class="ttname"><a href="structbtc__script__op__.html#a5d4882886c8cd495f6c71ee82328fa6b">btc_script_op_::op</a></div><div class="ttdeci">enum opcodetype op</div><div class="ttdef"><b>Definition:</b> <a href="script_8h_source.html#l00204">script.h:204</a></div></div>
<div class="ttc" id="structconst__buffer_html"><div class="ttname"><a href="structconst__buffer.html">const_buffer</a></div><div class="ttdef"><b>Definition:</b> <a href="buffer_8h_source.html#l00019">buffer.h:19</a></div></div>
<div class="ttc" id="structbtc__script__op___html_a55d375615cf71b0f3d5876c26acd1485"><div class="ttname"><a href="structbtc__script__op__.html#a55d375615cf71b0f3d5876c26acd1485">btc_script_op_::data</a></div><div class="ttdeci">unsigned char * data</div><div class="ttdef"><b>Definition:</b> <a href="script_8h_source.html#l00205">script.h:205</a></div></div>
<div class="ttc" id="script_8h_html_a63e349a6089a54da9fe09a3d858648bdac494676b542e0b7fb882a72f3f42fe46"><div class="ttname"><a href="script_8h.html#a63e349a6089a54da9fe09a3d858648bdac494676b542e0b7fb882a72f3f42fe46">OP_PUSHDATA2</a></div><div class="ttdef"><b>Definition:</b> <a href="script_8h_source.html#l00054">script.h:54</a></div></div>
<div class="ttc" id="script_8h_html_a63e349a6089a54da9fe09a3d858648bdaadaade1bfebdbc12e34cb1008a1c2941"><div class="ttname"><a href="script_8h.html#a63e349a6089a54da9fe09a3d858648bdaadaade1bfebdbc12e34cb1008a1c2941">OP_PUSHDATA1</a></div><div class="ttdef"><b>Definition:</b> <a href="script_8h_source.html#l00053">script.h:53</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab366c5b2c8adcdff51bb6776bec934a3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="btc_8h.html#a2426de7ad9dd5354f5e22b4c8d77e792">btc_bool</a> btc_script_is_multisig </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvector.html">vector</a> *&#160;</td>
          <td class="paramname"><em>ops</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="script_8c_source.html#l00227">227</a> of file <a class="el" href="script_8c_source.html">script.c</a>.</p>

<p>References <a class="el" href="script_8c_source.html#l00170">btc_script_is_op()</a>, <a class="el" href="script_8c_source.html#l00175">btc_script_is_op_pubkey()</a>, <a class="el" href="script_8c_source.html#l00221">btc_script_is_op_smallint()</a>, <a class="el" href="vector_8h_source.html#l00042">vector::len</a>, <a class="el" href="script_8h_source.html#l00167">OP_CHECKMULTISIG</a>, and <a class="el" href="vector_8h_source.html#l00059">vector_idx</a>.</p>

<p>Referenced by <a class="el" href="script_8c_source.html#l00243">btc_script_classify()</a>.</p>
<div class="fragment"><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;{</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="keywordflow">if</span> ((ops-&gt;<a class="code" href="structvector.html#abac364f9d74e0d6610c988003be1d167">len</a> &lt; 3) || (ops-&gt;<a class="code" href="structvector.html#abac364f9d74e0d6610c988003be1d167">len</a> &gt; (16 + 3)) ||</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        !<a class="code" href="script_8c.html#a5f2dab716094bb061ccfb989832627d1">btc_script_is_op_smallint</a>(<a class="code" href="vector_8h.html#a73977ea5971aad9c5d4a476d25ff1bc3">vector_idx</a>(ops, 0)) ||</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        !<a class="code" href="script_8c.html#a5f2dab716094bb061ccfb989832627d1">btc_script_is_op_smallint</a>(<a class="code" href="vector_8h.html#a73977ea5971aad9c5d4a476d25ff1bc3">vector_idx</a>(ops, ops-&gt;<a class="code" href="structvector.html#abac364f9d74e0d6610c988003be1d167">len</a> - 2)) ||</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        !<a class="code" href="script_8c.html#a7fafb2923ee233f3debab41e0445f5b2">btc_script_is_op</a>(<a class="code" href="vector_8h.html#a73977ea5971aad9c5d4a476d25ff1bc3">vector_idx</a>(ops, ops-&gt;<a class="code" href="structvector.html#abac364f9d74e0d6610c988003be1d167">len</a> - 1), <a class="code" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bda237677a3bb15c383d342aa297e7e9526">OP_CHECKMULTISIG</a>))</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="keywordflow">for</span> (i = 1; i &lt; (ops-&gt;<a class="code" href="structvector.html#abac364f9d74e0d6610c988003be1d167">len</a> - 2); i++)</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="script_8c.html#a307e1cee2f4af6577f94ba4b796214e7">btc_script_is_op_pubkey</a>(<a class="code" href="vector_8h.html#a73977ea5971aad9c5d4a476d25ff1bc3">vector_idx</a>(ops, i)))</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;}</div>
<div class="ttc" id="script_8h_html_a63e349a6089a54da9fe09a3d858648bda237677a3bb15c383d342aa297e7e9526"><div class="ttname"><a href="script_8h.html#a63e349a6089a54da9fe09a3d858648bda237677a3bb15c383d342aa297e7e9526">OP_CHECKMULTISIG</a></div><div class="ttdef"><b>Definition:</b> <a href="script_8h_source.html#l00167">script.h:167</a></div></div>
<div class="ttc" id="script_8c_html_a307e1cee2f4af6577f94ba4b796214e7"><div class="ttname"><a href="script_8c.html#a307e1cee2f4af6577f94ba4b796214e7">btc_script_is_op_pubkey</a></div><div class="ttdeci">static btc_bool btc_script_is_op_pubkey(const btc_script_op *op)</div><div class="ttdef"><b>Definition:</b> <a href="script_8c_source.html#l00175">script.c:175</a></div></div>
<div class="ttc" id="vector_8h_html_a73977ea5971aad9c5d4a476d25ff1bc3"><div class="ttname"><a href="vector_8h.html#a73977ea5971aad9c5d4a476d25ff1bc3">vector_idx</a></div><div class="ttdeci">#define vector_idx(vec, idx)</div><div class="ttdef"><b>Definition:</b> <a href="vector_8h_source.html#l00059">vector.h:59</a></div></div>
<div class="ttc" id="script_8c_html_a5f2dab716094bb061ccfb989832627d1"><div class="ttname"><a href="script_8c.html#a5f2dab716094bb061ccfb989832627d1">btc_script_is_op_smallint</a></div><div class="ttdeci">static btc_bool btc_script_is_op_smallint(const btc_script_op *op)</div><div class="ttdef"><b>Definition:</b> <a href="script_8c_source.html#l00221">script.c:221</a></div></div>
<div class="ttc" id="structvector_html_abac364f9d74e0d6610c988003be1d167"><div class="ttname"><a href="structvector.html#abac364f9d74e0d6610c988003be1d167">vector::len</a></div><div class="ttdeci">size_t len</div><div class="ttdef"><b>Definition:</b> <a href="vector_8h_source.html#l00042">vector.h:42</a></div></div>
<div class="ttc" id="script_8c_html_a7fafb2923ee233f3debab41e0445f5b2"><div class="ttname"><a href="script_8c.html#a7fafb2923ee233f3debab41e0445f5b2">btc_script_is_op</a></div><div class="ttdeci">static btc_bool btc_script_is_op(const btc_script_op *op, enum opcodetype opcode)</div><div class="ttdef"><b>Definition:</b> <a href="script_8c_source.html#l00170">script.c:170</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a7fafb2923ee233f3debab41e0445f5b2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="btc_8h.html#a2426de7ad9dd5354f5e22b4c8d77e792">btc_bool</a> btc_script_is_op </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="script_8h.html#aee43ea531cade9d64d41a2a0af3c9b26">btc_script_op</a> *&#160;</td>
          <td class="paramname"><em>op</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bd">opcodetype</a>&#160;</td>
          <td class="paramname"><em>opcode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="script_8c_source.html#l00170">170</a> of file <a class="el" href="script_8c_source.html">script.c</a>.</p>

<p>References <a class="el" href="script_8h_source.html#l00204">btc_script_op_::op</a>.</p>

<p>Referenced by <a class="el" href="script_8c_source.html#l00227">btc_script_is_multisig()</a>, <a class="el" href="script_8c_source.html#l00194">btc_script_is_pubkey()</a>, <a class="el" href="script_8c_source.html#l00202">btc_script_is_pubkeyhash()</a>, and <a class="el" href="script_8c_source.html#l00213">btc_script_is_scripthash()</a>.</p>
<div class="fragment"><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;{</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="keywordflow">return</span> (op-&gt;<a class="code" href="structbtc__script__op__.html#a5d4882886c8cd495f6c71ee82328fa6b">op</a> == opcode);</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;}</div>
<div class="ttc" id="structbtc__script__op___html_a5d4882886c8cd495f6c71ee82328fa6b"><div class="ttname"><a href="structbtc__script__op__.html#a5d4882886c8cd495f6c71ee82328fa6b">btc_script_op_::op</a></div><div class="ttdeci">enum opcodetype op</div><div class="ttdef"><b>Definition:</b> <a href="script_8h_source.html#l00204">script.h:204</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a307e1cee2f4af6577f94ba4b796214e7"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="btc_8h.html#a2426de7ad9dd5354f5e22b4c8d77e792">btc_bool</a> btc_script_is_op_pubkey </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="script_8h.html#aee43ea531cade9d64d41a2a0af3c9b26">btc_script_op</a> *&#160;</td>
          <td class="paramname"><em>op</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="script_8c_source.html#l00175">175</a> of file <a class="el" href="script_8c_source.html">script.c</a>.</p>

<p>References <a class="el" href="script_8c_source.html#l00165">btc_script_is_pushdata()</a>, <a class="el" href="script_8h_source.html#l00206">btc_script_op_::datalen</a>, and <a class="el" href="script_8h_source.html#l00204">btc_script_op_::op</a>.</p>

<p>Referenced by <a class="el" href="script_8c_source.html#l00227">btc_script_is_multisig()</a>, and <a class="el" href="script_8c_source.html#l00194">btc_script_is_pubkey()</a>.</p>
<div class="fragment"><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;{</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="script_8c.html#a7cd934910c35292ef622cb017b93a15f">btc_script_is_pushdata</a>(op-&gt;<a class="code" href="structbtc__script__op__.html#a5d4882886c8cd495f6c71ee82328fa6b">op</a>))</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="keywordflow">if</span> (op-&gt;<a class="code" href="structbtc__script__op__.html#a98d61935f3bd0ad810dbcb8e1f459f72">datalen</a> &lt; 33 || op-&gt;<a class="code" href="structbtc__script__op__.html#a98d61935f3bd0ad810dbcb8e1f459f72">datalen</a> &gt; 120)</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;}</div>
<div class="ttc" id="structbtc__script__op___html_a98d61935f3bd0ad810dbcb8e1f459f72"><div class="ttname"><a href="structbtc__script__op__.html#a98d61935f3bd0ad810dbcb8e1f459f72">btc_script_op_::datalen</a></div><div class="ttdeci">size_t datalen</div><div class="ttdef"><b>Definition:</b> <a href="script_8h_source.html#l00206">script.h:206</a></div></div>
<div class="ttc" id="script_8c_html_a7cd934910c35292ef622cb017b93a15f"><div class="ttname"><a href="script_8c.html#a7cd934910c35292ef622cb017b93a15f">btc_script_is_pushdata</a></div><div class="ttdeci">static btc_bool btc_script_is_pushdata(enum opcodetype op)</div><div class="ttdef"><b>Definition:</b> <a href="script_8c_source.html#l00165">script.c:165</a></div></div>
<div class="ttc" id="structbtc__script__op___html_a5d4882886c8cd495f6c71ee82328fa6b"><div class="ttname"><a href="structbtc__script__op__.html#a5d4882886c8cd495f6c71ee82328fa6b">btc_script_op_::op</a></div><div class="ttdeci">enum opcodetype op</div><div class="ttdef"><b>Definition:</b> <a href="script_8h_source.html#l00204">script.h:204</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2892d15f4f0a4013466f6d0f3883a710"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="btc_8h.html#a2426de7ad9dd5354f5e22b4c8d77e792">btc_bool</a> btc_script_is_op_pubkeyhash </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="script_8h.html#aee43ea531cade9d64d41a2a0af3c9b26">btc_script_op</a> *&#160;</td>
          <td class="paramname"><em>op</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="script_8c_source.html#l00184">184</a> of file <a class="el" href="script_8c_source.html">script.c</a>.</p>

<p>References <a class="el" href="script_8c_source.html#l00165">btc_script_is_pushdata()</a>, <a class="el" href="script_8h_source.html#l00206">btc_script_op_::datalen</a>, and <a class="el" href="script_8h_source.html#l00204">btc_script_op_::op</a>.</p>

<p>Referenced by <a class="el" href="script_8c_source.html#l00202">btc_script_is_pubkeyhash()</a>, and <a class="el" href="script_8c_source.html#l00213">btc_script_is_scripthash()</a>.</p>
<div class="fragment"><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;{</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="script_8c.html#a7cd934910c35292ef622cb017b93a15f">btc_script_is_pushdata</a>(op-&gt;<a class="code" href="structbtc__script__op__.html#a5d4882886c8cd495f6c71ee82328fa6b">op</a>))</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="keywordflow">if</span> (op-&gt;<a class="code" href="structbtc__script__op__.html#a98d61935f3bd0ad810dbcb8e1f459f72">datalen</a> != 20)</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;}</div>
<div class="ttc" id="structbtc__script__op___html_a98d61935f3bd0ad810dbcb8e1f459f72"><div class="ttname"><a href="structbtc__script__op__.html#a98d61935f3bd0ad810dbcb8e1f459f72">btc_script_op_::datalen</a></div><div class="ttdeci">size_t datalen</div><div class="ttdef"><b>Definition:</b> <a href="script_8h_source.html#l00206">script.h:206</a></div></div>
<div class="ttc" id="script_8c_html_a7cd934910c35292ef622cb017b93a15f"><div class="ttname"><a href="script_8c.html#a7cd934910c35292ef622cb017b93a15f">btc_script_is_pushdata</a></div><div class="ttdeci">static btc_bool btc_script_is_pushdata(enum opcodetype op)</div><div class="ttdef"><b>Definition:</b> <a href="script_8c_source.html#l00165">script.c:165</a></div></div>
<div class="ttc" id="structbtc__script__op___html_a5d4882886c8cd495f6c71ee82328fa6b"><div class="ttname"><a href="structbtc__script__op__.html#a5d4882886c8cd495f6c71ee82328fa6b">btc_script_op_::op</a></div><div class="ttdeci">enum opcodetype op</div><div class="ttdef"><b>Definition:</b> <a href="script_8h_source.html#l00204">script.h:204</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a5f2dab716094bb061ccfb989832627d1"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="btc_8h.html#a2426de7ad9dd5354f5e22b4c8d77e792">btc_bool</a> btc_script_is_op_smallint </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="script_8h.html#aee43ea531cade9d64d41a2a0af3c9b26">btc_script_op</a> *&#160;</td>
          <td class="paramname"><em>op</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="script_8c_source.html#l00221">221</a> of file <a class="el" href="script_8c_source.html">script.c</a>.</p>

<p>References <a class="el" href="script_8h_source.html#l00204">btc_script_op_::op</a>, <a class="el" href="script_8h_source.html#l00051">OP_0</a>, <a class="el" href="script_8h_source.html#l00058">OP_1</a>, and <a class="el" href="script_8h_source.html#l00074">OP_16</a>.</p>

<p>Referenced by <a class="el" href="script_8c_source.html#l00227">btc_script_is_multisig()</a>.</p>
<div class="fragment"><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;{</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="keywordflow">return</span> ((op-&gt;<a class="code" href="structbtc__script__op__.html#a5d4882886c8cd495f6c71ee82328fa6b">op</a> == <a class="code" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bdaccd484dad2223fffdbdc2637c4f1e40e">OP_0</a>) ||</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;            (op-&gt;<a class="code" href="structbtc__script__op__.html#a5d4882886c8cd495f6c71ee82328fa6b">op</a> &gt;= <a class="code" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bda7e89d91965ffa7edb7733a5e9bf8a9f3">OP_1</a> &amp;&amp; op-&gt;<a class="code" href="structbtc__script__op__.html#a5d4882886c8cd495f6c71ee82328fa6b">op</a> &lt;= <a class="code" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bda2ee6a5016b745258463b6d206e7332c9">OP_16</a>));</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;}</div>
<div class="ttc" id="script_8h_html_a63e349a6089a54da9fe09a3d858648bda2ee6a5016b745258463b6d206e7332c9"><div class="ttname"><a href="script_8h.html#a63e349a6089a54da9fe09a3d858648bda2ee6a5016b745258463b6d206e7332c9">OP_16</a></div><div class="ttdef"><b>Definition:</b> <a href="script_8h_source.html#l00074">script.h:74</a></div></div>
<div class="ttc" id="script_8h_html_a63e349a6089a54da9fe09a3d858648bda7e89d91965ffa7edb7733a5e9bf8a9f3"><div class="ttname"><a href="script_8h.html#a63e349a6089a54da9fe09a3d858648bda7e89d91965ffa7edb7733a5e9bf8a9f3">OP_1</a></div><div class="ttdef"><b>Definition:</b> <a href="script_8h_source.html#l00058">script.h:58</a></div></div>
<div class="ttc" id="structbtc__script__op___html_a5d4882886c8cd495f6c71ee82328fa6b"><div class="ttname"><a href="structbtc__script__op__.html#a5d4882886c8cd495f6c71ee82328fa6b">btc_script_op_::op</a></div><div class="ttdeci">enum opcodetype op</div><div class="ttdef"><b>Definition:</b> <a href="script_8h_source.html#l00204">script.h:204</a></div></div>
<div class="ttc" id="script_8h_html_a63e349a6089a54da9fe09a3d858648bdaccd484dad2223fffdbdc2637c4f1e40e"><div class="ttname"><a href="script_8h.html#a63e349a6089a54da9fe09a3d858648bdaccd484dad2223fffdbdc2637c4f1e40e">OP_0</a></div><div class="ttdef"><b>Definition:</b> <a href="script_8h_source.html#l00051">script.h:51</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a992fde7b9a8b9178e70337fe7646d813"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="btc_8h.html#a2426de7ad9dd5354f5e22b4c8d77e792">btc_bool</a> btc_script_is_pubkey </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvector.html">vector</a> *&#160;</td>
          <td class="paramname"><em>ops</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="script_8c_source.html#l00194">194</a> of file <a class="el" href="script_8c_source.html">script.c</a>.</p>

<p>References <a class="el" href="script_8c_source.html#l00170">btc_script_is_op()</a>, <a class="el" href="script_8c_source.html#l00175">btc_script_is_op_pubkey()</a>, <a class="el" href="vector_8h_source.html#l00042">vector::len</a>, <a class="el" href="script_8h_source.html#l00165">OP_CHECKSIG</a>, and <a class="el" href="vector_8h_source.html#l00059">vector_idx</a>.</p>

<p>Referenced by <a class="el" href="script_8c_source.html#l00243">btc_script_classify()</a>.</p>
<div class="fragment"><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;{</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="keywordflow">return</span> ((ops-&gt;<a class="code" href="structvector.html#abac364f9d74e0d6610c988003be1d167">len</a> == 2) &amp;&amp;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;            <a class="code" href="script_8c.html#a7fafb2923ee233f3debab41e0445f5b2">btc_script_is_op</a>(<a class="code" href="vector_8h.html#a73977ea5971aad9c5d4a476d25ff1bc3">vector_idx</a>(ops, 1), <a class="code" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bda2c190c5caf052f92d3d9ac31a0d96151">OP_CHECKSIG</a>) &amp;&amp;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;            <a class="code" href="script_8c.html#a307e1cee2f4af6577f94ba4b796214e7">btc_script_is_op_pubkey</a>(<a class="code" href="vector_8h.html#a73977ea5971aad9c5d4a476d25ff1bc3">vector_idx</a>(ops, 0)));</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;}</div>
<div class="ttc" id="script_8h_html_a63e349a6089a54da9fe09a3d858648bda2c190c5caf052f92d3d9ac31a0d96151"><div class="ttname"><a href="script_8h.html#a63e349a6089a54da9fe09a3d858648bda2c190c5caf052f92d3d9ac31a0d96151">OP_CHECKSIG</a></div><div class="ttdef"><b>Definition:</b> <a href="script_8h_source.html#l00165">script.h:165</a></div></div>
<div class="ttc" id="script_8c_html_a307e1cee2f4af6577f94ba4b796214e7"><div class="ttname"><a href="script_8c.html#a307e1cee2f4af6577f94ba4b796214e7">btc_script_is_op_pubkey</a></div><div class="ttdeci">static btc_bool btc_script_is_op_pubkey(const btc_script_op *op)</div><div class="ttdef"><b>Definition:</b> <a href="script_8c_source.html#l00175">script.c:175</a></div></div>
<div class="ttc" id="vector_8h_html_a73977ea5971aad9c5d4a476d25ff1bc3"><div class="ttname"><a href="vector_8h.html#a73977ea5971aad9c5d4a476d25ff1bc3">vector_idx</a></div><div class="ttdeci">#define vector_idx(vec, idx)</div><div class="ttdef"><b>Definition:</b> <a href="vector_8h_source.html#l00059">vector.h:59</a></div></div>
<div class="ttc" id="structvector_html_abac364f9d74e0d6610c988003be1d167"><div class="ttname"><a href="structvector.html#abac364f9d74e0d6610c988003be1d167">vector::len</a></div><div class="ttdeci">size_t len</div><div class="ttdef"><b>Definition:</b> <a href="vector_8h_source.html#l00042">vector.h:42</a></div></div>
<div class="ttc" id="script_8c_html_a7fafb2923ee233f3debab41e0445f5b2"><div class="ttname"><a href="script_8c.html#a7fafb2923ee233f3debab41e0445f5b2">btc_script_is_op</a></div><div class="ttdeci">static btc_bool btc_script_is_op(const btc_script_op *op, enum opcodetype opcode)</div><div class="ttdef"><b>Definition:</b> <a href="script_8c_source.html#l00170">script.c:170</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a104cab956788e243c00e157372d852d4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="btc_8h.html#a2426de7ad9dd5354f5e22b4c8d77e792">btc_bool</a> btc_script_is_pubkeyhash </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvector.html">vector</a> *&#160;</td>
          <td class="paramname"><em>ops</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="script_8c_source.html#l00202">202</a> of file <a class="el" href="script_8c_source.html">script.c</a>.</p>

<p>References <a class="el" href="script_8c_source.html#l00170">btc_script_is_op()</a>, <a class="el" href="script_8c_source.html#l00184">btc_script_is_op_pubkeyhash()</a>, <a class="el" href="vector_8h_source.html#l00042">vector::len</a>, <a class="el" href="script_8h_source.html#l00165">OP_CHECKSIG</a>, <a class="el" href="script_8h_source.html#l00100">OP_DUP</a>, <a class="el" href="script_8h_source.html#l00122">OP_EQUALVERIFY</a>, <a class="el" href="script_8h_source.html#l00162">OP_HASH160</a>, and <a class="el" href="vector_8h_source.html#l00059">vector_idx</a>.</p>

<p>Referenced by <a class="el" href="script_8c_source.html#l00243">btc_script_classify()</a>.</p>
<div class="fragment"><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;{</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="keywordflow">return</span> ((ops-&gt;<a class="code" href="structvector.html#abac364f9d74e0d6610c988003be1d167">len</a> == 5) &amp;&amp;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;            <a class="code" href="script_8c.html#a7fafb2923ee233f3debab41e0445f5b2">btc_script_is_op</a>(<a class="code" href="vector_8h.html#a73977ea5971aad9c5d4a476d25ff1bc3">vector_idx</a>(ops, 0), <a class="code" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bda47360cbb2e673baa31591adbb153c9b3">OP_DUP</a>) &amp;&amp;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;            <a class="code" href="script_8c.html#a7fafb2923ee233f3debab41e0445f5b2">btc_script_is_op</a>(<a class="code" href="vector_8h.html#a73977ea5971aad9c5d4a476d25ff1bc3">vector_idx</a>(ops, 1), <a class="code" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bda73c89133f3d2bdf12ac1ec91e06ba3cd">OP_HASH160</a>) &amp;&amp;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;            <a class="code" href="script_8c.html#a2892d15f4f0a4013466f6d0f3883a710">btc_script_is_op_pubkeyhash</a>(<a class="code" href="vector_8h.html#a73977ea5971aad9c5d4a476d25ff1bc3">vector_idx</a>(ops, 2)) &amp;&amp;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;            <a class="code" href="script_8c.html#a7fafb2923ee233f3debab41e0445f5b2">btc_script_is_op</a>(<a class="code" href="vector_8h.html#a73977ea5971aad9c5d4a476d25ff1bc3">vector_idx</a>(ops, 3), <a class="code" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bdae24d4b553a43d3d57bbac4d9bd4bdf24">OP_EQUALVERIFY</a>) &amp;&amp;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;            <a class="code" href="script_8c.html#a7fafb2923ee233f3debab41e0445f5b2">btc_script_is_op</a>(<a class="code" href="vector_8h.html#a73977ea5971aad9c5d4a476d25ff1bc3">vector_idx</a>(ops, 4), <a class="code" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bda2c190c5caf052f92d3d9ac31a0d96151">OP_CHECKSIG</a>));</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;}</div>
<div class="ttc" id="script_8h_html_a63e349a6089a54da9fe09a3d858648bdae24d4b553a43d3d57bbac4d9bd4bdf24"><div class="ttname"><a href="script_8h.html#a63e349a6089a54da9fe09a3d858648bdae24d4b553a43d3d57bbac4d9bd4bdf24">OP_EQUALVERIFY</a></div><div class="ttdef"><b>Definition:</b> <a href="script_8h_source.html#l00122">script.h:122</a></div></div>
<div class="ttc" id="script_8h_html_a63e349a6089a54da9fe09a3d858648bda2c190c5caf052f92d3d9ac31a0d96151"><div class="ttname"><a href="script_8h.html#a63e349a6089a54da9fe09a3d858648bda2c190c5caf052f92d3d9ac31a0d96151">OP_CHECKSIG</a></div><div class="ttdef"><b>Definition:</b> <a href="script_8h_source.html#l00165">script.h:165</a></div></div>
<div class="ttc" id="script_8h_html_a63e349a6089a54da9fe09a3d858648bda73c89133f3d2bdf12ac1ec91e06ba3cd"><div class="ttname"><a href="script_8h.html#a63e349a6089a54da9fe09a3d858648bda73c89133f3d2bdf12ac1ec91e06ba3cd">OP_HASH160</a></div><div class="ttdef"><b>Definition:</b> <a href="script_8h_source.html#l00162">script.h:162</a></div></div>
<div class="ttc" id="vector_8h_html_a73977ea5971aad9c5d4a476d25ff1bc3"><div class="ttname"><a href="vector_8h.html#a73977ea5971aad9c5d4a476d25ff1bc3">vector_idx</a></div><div class="ttdeci">#define vector_idx(vec, idx)</div><div class="ttdef"><b>Definition:</b> <a href="vector_8h_source.html#l00059">vector.h:59</a></div></div>
<div class="ttc" id="structvector_html_abac364f9d74e0d6610c988003be1d167"><div class="ttname"><a href="structvector.html#abac364f9d74e0d6610c988003be1d167">vector::len</a></div><div class="ttdeci">size_t len</div><div class="ttdef"><b>Definition:</b> <a href="vector_8h_source.html#l00042">vector.h:42</a></div></div>
<div class="ttc" id="script_8c_html_a7fafb2923ee233f3debab41e0445f5b2"><div class="ttname"><a href="script_8c.html#a7fafb2923ee233f3debab41e0445f5b2">btc_script_is_op</a></div><div class="ttdeci">static btc_bool btc_script_is_op(const btc_script_op *op, enum opcodetype opcode)</div><div class="ttdef"><b>Definition:</b> <a href="script_8c_source.html#l00170">script.c:170</a></div></div>
<div class="ttc" id="script_8c_html_a2892d15f4f0a4013466f6d0f3883a710"><div class="ttname"><a href="script_8c.html#a2892d15f4f0a4013466f6d0f3883a710">btc_script_is_op_pubkeyhash</a></div><div class="ttdeci">static btc_bool btc_script_is_op_pubkeyhash(const btc_script_op *op)</div><div class="ttdef"><b>Definition:</b> <a href="script_8c_source.html#l00184">script.c:184</a></div></div>
<div class="ttc" id="script_8h_html_a63e349a6089a54da9fe09a3d858648bda47360cbb2e673baa31591adbb153c9b3"><div class="ttname"><a href="script_8h.html#a63e349a6089a54da9fe09a3d858648bda47360cbb2e673baa31591adbb153c9b3">OP_DUP</a></div><div class="ttdef"><b>Definition:</b> <a href="script_8h_source.html#l00100">script.h:100</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a7cd934910c35292ef622cb017b93a15f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="btc_8h.html#a2426de7ad9dd5354f5e22b4c8d77e792">btc_bool</a> btc_script_is_pushdata </td>
          <td>(</td>
          <td class="paramtype">enum <a class="el" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bd">opcodetype</a>&#160;</td>
          <td class="paramname"><em>op</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="script_8c_source.html#l00165">165</a> of file <a class="el" href="script_8c_source.html">script.c</a>.</p>

<p>References <a class="el" href="script_8h_source.html#l00055">OP_PUSHDATA4</a>.</p>

<p>Referenced by <a class="el" href="script_8c_source.html#l00175">btc_script_is_op_pubkey()</a>, and <a class="el" href="script_8c_source.html#l00184">btc_script_is_op_pubkeyhash()</a>.</p>
<div class="fragment"><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;{</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="keywordflow">return</span> (op &lt;= <a class="code" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bda18ab5e1ed9ddbf9e18ea9761d12a3c02">OP_PUSHDATA4</a>);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;}</div>
<div class="ttc" id="script_8h_html_a63e349a6089a54da9fe09a3d858648bda18ab5e1ed9ddbf9e18ea9761d12a3c02"><div class="ttname"><a href="script_8h.html#a63e349a6089a54da9fe09a3d858648bda18ab5e1ed9ddbf9e18ea9761d12a3c02">OP_PUSHDATA4</a></div><div class="ttdef"><b>Definition:</b> <a href="script_8h_source.html#l00055">script.h:55</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a702b03d4e597b5d6ccdda6c15fd472e0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="btc_8h.html#a2426de7ad9dd5354f5e22b4c8d77e792">btc_bool</a> btc_script_is_scripthash </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structvector.html">vector</a> *&#160;</td>
          <td class="paramname"><em>ops</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="script_8c_source.html#l00213">213</a> of file <a class="el" href="script_8c_source.html">script.c</a>.</p>

<p>References <a class="el" href="script_8c_source.html#l00170">btc_script_is_op()</a>, <a class="el" href="script_8c_source.html#l00184">btc_script_is_op_pubkeyhash()</a>, <a class="el" href="vector_8h_source.html#l00042">vector::len</a>, <a class="el" href="script_8h_source.html#l00121">OP_EQUAL</a>, <a class="el" href="script_8h_source.html#l00162">OP_HASH160</a>, and <a class="el" href="vector_8h_source.html#l00059">vector_idx</a>.</p>

<p>Referenced by <a class="el" href="script_8c_source.html#l00243">btc_script_classify()</a>.</p>
<div class="fragment"><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;{</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="keywordflow">return</span> ((ops-&gt;<a class="code" href="structvector.html#abac364f9d74e0d6610c988003be1d167">len</a> == 3) &amp;&amp;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;            <a class="code" href="script_8c.html#a7fafb2923ee233f3debab41e0445f5b2">btc_script_is_op</a>(<a class="code" href="vector_8h.html#a73977ea5971aad9c5d4a476d25ff1bc3">vector_idx</a>(ops, 0), <a class="code" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bda73c89133f3d2bdf12ac1ec91e06ba3cd">OP_HASH160</a>) &amp;&amp;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;            <a class="code" href="script_8c.html#a2892d15f4f0a4013466f6d0f3883a710">btc_script_is_op_pubkeyhash</a>(<a class="code" href="vector_8h.html#a73977ea5971aad9c5d4a476d25ff1bc3">vector_idx</a>(ops, 1)) &amp;&amp;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;            <a class="code" href="script_8c.html#a7fafb2923ee233f3debab41e0445f5b2">btc_script_is_op</a>(<a class="code" href="vector_8h.html#a73977ea5971aad9c5d4a476d25ff1bc3">vector_idx</a>(ops, 2), <a class="code" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bda383e0c5476b2ddc1839af951b393ca17">OP_EQUAL</a>));</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;}</div>
<div class="ttc" id="script_8h_html_a63e349a6089a54da9fe09a3d858648bda73c89133f3d2bdf12ac1ec91e06ba3cd"><div class="ttname"><a href="script_8h.html#a63e349a6089a54da9fe09a3d858648bda73c89133f3d2bdf12ac1ec91e06ba3cd">OP_HASH160</a></div><div class="ttdef"><b>Definition:</b> <a href="script_8h_source.html#l00162">script.h:162</a></div></div>
<div class="ttc" id="vector_8h_html_a73977ea5971aad9c5d4a476d25ff1bc3"><div class="ttname"><a href="vector_8h.html#a73977ea5971aad9c5d4a476d25ff1bc3">vector_idx</a></div><div class="ttdeci">#define vector_idx(vec, idx)</div><div class="ttdef"><b>Definition:</b> <a href="vector_8h_source.html#l00059">vector.h:59</a></div></div>
<div class="ttc" id="structvector_html_abac364f9d74e0d6610c988003be1d167"><div class="ttname"><a href="structvector.html#abac364f9d74e0d6610c988003be1d167">vector::len</a></div><div class="ttdeci">size_t len</div><div class="ttdef"><b>Definition:</b> <a href="vector_8h_source.html#l00042">vector.h:42</a></div></div>
<div class="ttc" id="script_8h_html_a63e349a6089a54da9fe09a3d858648bda383e0c5476b2ddc1839af951b393ca17"><div class="ttname"><a href="script_8h.html#a63e349a6089a54da9fe09a3d858648bda383e0c5476b2ddc1839af951b393ca17">OP_EQUAL</a></div><div class="ttdef"><b>Definition:</b> <a href="script_8h_source.html#l00121">script.h:121</a></div></div>
<div class="ttc" id="script_8c_html_a7fafb2923ee233f3debab41e0445f5b2"><div class="ttname"><a href="script_8c.html#a7fafb2923ee233f3debab41e0445f5b2">btc_script_is_op</a></div><div class="ttdeci">static btc_bool btc_script_is_op(const btc_script_op *op, enum opcodetype opcode)</div><div class="ttdef"><b>Definition:</b> <a href="script_8c_source.html#l00170">script.c:170</a></div></div>
<div class="ttc" id="script_8c_html_a2892d15f4f0a4013466f6d0f3883a710"><div class="ttname"><a href="script_8c.html#a2892d15f4f0a4013466f6d0f3883a710">btc_script_is_op_pubkeyhash</a></div><div class="ttdeci">static btc_bool btc_script_is_op_pubkeyhash(const btc_script_op *op)</div><div class="ttdef"><b>Definition:</b> <a href="script_8c_source.html#l00184">script.c:184</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aea847aa69db6d03ee2eca62a0422c12e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void btc_script_op_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="script_8h.html#aee43ea531cade9d64d41a2a0af3c9b26">btc_script_op</a> *&#160;</td>
          <td class="paramname"><em>script_op</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="script_8c_source.html#l00090">90</a> of file <a class="el" href="script_8c_source.html">script.c</a>.</p>

<p>References <a class="el" href="script_8h_source.html#l00205">btc_script_op_::data</a>, <a class="el" href="script_8h_source.html#l00206">btc_script_op_::datalen</a>, <a class="el" href="script_8h_source.html#l00204">btc_script_op_::op</a>, and <a class="el" href="script_8h_source.html#l00051">OP_0</a>.</p>

<p>Referenced by <a class="el" href="script_8c_source.html#l00108">btc_script_get_ops()</a>, and <a class="el" href="script_8c_source.html#l00100">btc_script_op_free_cb()</a>.</p>
<div class="fragment"><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;{</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="keywordflow">if</span> (script_op-&gt;<a class="code" href="structbtc__script__op__.html#a55d375615cf71b0f3d5876c26acd1485">data</a>) {</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        free(script_op-&gt;<a class="code" href="structbtc__script__op__.html#a55d375615cf71b0f3d5876c26acd1485">data</a>);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        script_op-&gt;<a class="code" href="structbtc__script__op__.html#a55d375615cf71b0f3d5876c26acd1485">data</a> = NULL;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    }</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    script_op-&gt;<a class="code" href="structbtc__script__op__.html#a98d61935f3bd0ad810dbcb8e1f459f72">datalen</a> = 0;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    script_op-&gt;<a class="code" href="structbtc__script__op__.html#a5d4882886c8cd495f6c71ee82328fa6b">op</a> = <a class="code" href="script_8h.html#a63e349a6089a54da9fe09a3d858648bdaccd484dad2223fffdbdc2637c4f1e40e">OP_0</a>;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;}</div>
<div class="ttc" id="structbtc__script__op___html_a98d61935f3bd0ad810dbcb8e1f459f72"><div class="ttname"><a href="structbtc__script__op__.html#a98d61935f3bd0ad810dbcb8e1f459f72">btc_script_op_::datalen</a></div><div class="ttdeci">size_t datalen</div><div class="ttdef"><b>Definition:</b> <a href="script_8h_source.html#l00206">script.h:206</a></div></div>
<div class="ttc" id="structbtc__script__op___html_a5d4882886c8cd495f6c71ee82328fa6b"><div class="ttname"><a href="structbtc__script__op__.html#a5d4882886c8cd495f6c71ee82328fa6b">btc_script_op_::op</a></div><div class="ttdeci">enum opcodetype op</div><div class="ttdef"><b>Definition:</b> <a href="script_8h_source.html#l00204">script.h:204</a></div></div>
<div class="ttc" id="script_8h_html_a63e349a6089a54da9fe09a3d858648bdaccd484dad2223fffdbdc2637c4f1e40e"><div class="ttname"><a href="script_8h.html#a63e349a6089a54da9fe09a3d858648bdaccd484dad2223fffdbdc2637c4f1e40e">OP_0</a></div><div class="ttdef"><b>Definition:</b> <a href="script_8h_source.html#l00051">script.h:51</a></div></div>
<div class="ttc" id="structbtc__script__op___html_a55d375615cf71b0f3d5876c26acd1485"><div class="ttname"><a href="structbtc__script__op__.html#a55d375615cf71b0f3d5876c26acd1485">btc_script_op_::data</a></div><div class="ttdeci">unsigned char * data</div><div class="ttdef"><b>Definition:</b> <a href="script_8h_source.html#l00205">script.h:205</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="acbd932644e53ed44327bf9d87632a1f8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void btc_script_op_free_cb </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="script_8c_source.html#l00100">100</a> of file <a class="el" href="script_8c_source.html">script.c</a>.</p>

<p>References <a class="el" href="script_8c_source.html#l00090">btc_script_op_free()</a>.</p>
<div class="fragment"><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;{</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <a class="code" href="structbtc__script__op__.html">btc_script_op</a>* script_op = data;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <a class="code" href="script_8c.html#aea847aa69db6d03ee2eca62a0422c12e">btc_script_op_free</a>(script_op);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    free(script_op);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;}</div>
<div class="ttc" id="script_8c_html_aea847aa69db6d03ee2eca62a0422c12e"><div class="ttname"><a href="script_8c.html#aea847aa69db6d03ee2eca62a0422c12e">btc_script_op_free</a></div><div class="ttdeci">void btc_script_op_free(btc_script_op *script_op)</div><div class="ttdef"><b>Definition:</b> <a href="script_8c_source.html#l00090">script.c:90</a></div></div>
<div class="ttc" id="structbtc__script__op___html"><div class="ttname"><a href="structbtc__script__op__.html">btc_script_op_</a></div><div class="ttdef"><b>Definition:</b> <a href="script_8h_source.html#l00202">script.h:202</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3701ef637831f94ec0bde2da6920cc56"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="script_8h.html#aee43ea531cade9d64d41a2a0af3c9b26">btc_script_op</a>* btc_script_op_new </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="script_8c_source.html#l00081">81</a> of file <a class="el" href="script_8c_source.html">script.c</a>.</p>

<p>Referenced by <a class="el" href="script_8c_source.html#l00108">btc_script_get_ops()</a>.</p>
<div class="fragment"><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;{</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <a class="code" href="structbtc__script__op__.html">btc_script_op</a>* script_op;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    script_op = calloc(1, <span class="keyword">sizeof</span>(*script_op));</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="keywordflow">return</span> script_op;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;}</div>
<div class="ttc" id="structbtc__script__op___html"><div class="ttname"><a href="structbtc__script__op__.html">btc_script_op_</a></div><div class="ttdef"><b>Definition:</b> <a href="script_8h_source.html#l00202">script.h:202</a></div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Oct 27 2015 18:34:53 for libbtc by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.10
</small></address>
</body>
</html>
